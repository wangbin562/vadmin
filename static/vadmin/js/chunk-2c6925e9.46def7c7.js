(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2c6925e9"],{"150e":function(t,e,i){"use strict";i("d17e")},"4df4":function(t,e,i){"use strict";var a=i("0366"),n=i("7b0b"),r=i("9bdd"),l=i("e95a"),s=i("68ee"),o=i("07fa"),h=i("8418"),d=i("9a1f"),c=i("35a1");t.exports=function(t){var e=n(t),i=s(this),g=arguments.length,p=g>1?arguments[1]:void 0,u=void 0!==p;u&&(p=a(p,g>2?arguments[2]:void 0,2));var _,v,f,w,m,x,b=c(e),y=0;if(!b||this==Array&&l(b))for(_=o(e),v=i?new this(_):Array(_);_>y;y++)x=u?p(e[y],y):e[y],h(v,y,x);else for(w=d(e,b),m=w.next,v=i?new this:[];!(f=m.call(w)).done;y++)x=u?r(w,p,[f.value,y],!0):f.value,h(v,y,x);return v.length=y,v}},5026:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"svgBox",staticClass:"svgBox",style:t.svgBoxStyle(),attrs:{id:t.id,name:t.name}},[i("div",{ref:"controll_bar",staticClass:"controll_bar",style:{width:"100%"}},[t.is_save?i("div",{staticClass:"sizeSelect sizeSelect_svg",on:{click:t.save,mouseenter:function(e){t.showTips(e,"保存(Ctrl+S)")},mouseleave:t.closeTips}},[i("svg",{staticClass:"icon",attrs:{t:"1604710496631",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3208",width:"16",height:"16"}},[i("path",{attrs:{d:"M245 128H133a8 8 0 0 0-8 8v752a8 8 0 0 0 8 8h752a8 8 0 0 0 8-8V136a8 8 0 0 0-8-8H774v321c0 17.673-14.327 32-32 32H277c-17.673 0-32-14.327-32-32V128zM93 64h832c17.673 0 32 14.327 32 32v832c0 17.673-14.327 32-32 32H93c-17.673 0-32-14.327-32-32V96c0-17.673 14.327-32 32-32z m224 64a8 8 0 0 0-8 8v273a8 8 0 0 0 8 8h385a8 8 0 0 0 8-8V136a8 8 0 0 0-8-8H317z m304 35c17.673 0 32 14.327 32 32v145c0 17.673-14.327 32-32 32-17.673 0-32-14.327-32-32V195c0-17.673 14.327-32 32-32z","p-id":"3209",fill:"#3D4757"}})])]):t._e(),i("div",{staticClass:"component-divider"}),i("div",{class:["sizeSelect",{"sizeSelect-active":4==t.insertShow}],on:{click:function(e){return t.handelListShow(4)}}},[i("span",{staticClass:"sizeText",style:{"font-size":"12px","font-family":t.family},on:{mouseenter:function(e){return t.showTips(e,"字体")},mouseleave:t.closeTips}},[t._v(t._s(t.family))]),i("div",{directives:[{name:"show",rawName:"v-show",value:4==t.insertShow,expression:"insertShow==4"}],staticClass:"sizeSelectList",staticStyle:{"overflow-y":"auto"}},t._l(t.options_font_family,(function(e,a){return i("div",{key:a,staticClass:"sizeSelectItem",on:{click:function(i){return t.handelFamilyChange(e)}}},[i("span",{style:{"font-family":e}},[t._v(t._s(e))]),t.family==e?i("svg",{attrs:{height:"16",width:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M6.586 9.828l5.657-5.656 1.414 1.414L8 11.243l-1.414 1.414-4.243-4.243L3.757 7l2.829 2.828z",fill:"#4991F2","fill-rule":"evenodd"}})]):t._e()])})),0)]),i("div",{class:["sizeSelect",{"sizeSelect-active":1==t.insertShow}],staticStyle:{width:"45px"},on:{click:function(e){return t.handelListShow(1)}}},[i("span",{staticClass:"sizeText",on:{mouseenter:function(e){return t.showTips(e,"字体大小")},mouseleave:t.closeTips}},[t._v(t._s(t.currentFontSizeName))]),i("div",{directives:[{name:"show",rawName:"v-show",value:1==t.insertShow,expression:"insertShow==1"}],staticClass:"sizeSelectList",staticStyle:{"max-height":"300px","overflow-y":"auto"}},t._l(t.options_font_size,(function(e,a){return i("div",{key:a,staticClass:"sizeSelectItem",staticStyle:{width:"90px"},on:{click:function(i){return t.handelSizeChange(e)}}},[i("span",[t._v(t._s(e.label))]),t.currentFontSizeName==e.label?i("svg",{attrs:{height:"16",width:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M6.586 9.828l5.657-5.656 1.414 1.414L8 11.243l-1.414 1.414-4.243-4.243L3.757 7l2.829 2.828z",fill:"#4991F2","fill-rule":"evenodd"}})]):t._e()])})),0)]),i("div",{staticClass:"component-divider"}),i("div",{class:["sizeSelect sizeSelect_svg",{selected:t.bold}],on:{click:function(e){return t.textBaseStyleChange(3)},mouseenter:function(e){t.showTips(e,"粗体(Ctrl+B)")},mouseleave:t.closeTips}},[i("svg",{attrs:{height:"16",width:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M8.131 6.9c2.035 0 2.569-.9 2.569-1.869 0-.968-.64-1.831-2.623-1.831H5.2v3.7h2.931zm.524 5.9c2.045 0 2.545-1.305 2.545-2.3 0-.985-.506-2.4-2.81-2.4H5.2v4.7h3.455zM4 2h4.71c2.367 0 3.19 1.583 3.19 3s-.325 1.852-1.1 2.5c1.2.5 1.569 1.379 1.6 3 .03 1.606-.586 3.5-3.769 3.5H4V2z",fill:"#3D4757","fill-rule":"evenodd"}})])]),i("div",{class:["sizeSelect sizeSelect_svg",{selected:t.italic}],on:{click:function(e){return t.textBaseStyleChange(4)},mouseenter:function(e){t.showTips(e,"斜体(Ctrl+I)")},mouseleave:t.closeTips}},[i("svg",{attrs:{height:"16",width:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M10.017 3L8.08 13H9v1H6v-1h1.182L9 3H8V2h3v1h-.983z",fill:"#3D4757"}})])]),i("div",{class:["sizeSelect sizeSelect_svg",{selected:t.underline}],on:{click:function(e){return t.textBaseStyleChange(5)},mouseenter:function(e){t.showTips(e,"下划线(Ctrl+U)")},mouseleave:t.closeTips}},[i("svg",{attrs:{height:"16",width:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M5 2v6a3 3 0 1 0 6 0V2h1v6a4 4 0 1 1-8 0V2h1zM4 13h8v1H4z",fill:"#3D4757"}})])]),i("div",{class:["sizeSelect sizeSelect_svg",{selected:t.line_through}],on:{click:function(e){return t.textBaseStyleChange(6)},mouseenter:function(e){return t.showTips(e,"删除线")},mouseleave:t.closeTips}},[i("svg",{attrs:{height:"16",width:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("g",{attrs:{fill:"#3D4757","fill-rule":"evenodd"}},[i("path",{attrs:{d:"M10.42 7.903H6.692a9.182 9.182 0 0 1-.41-.172 5.54 5.54 0 0 1-.814-.447 2.955 2.955 0 0 1-.655-.595 2.728 2.728 0 0 1-.44-.777 2.877 2.877 0 0 1-.162-1.006c0-.472.094-.888.282-1.25.188-.36.453-.663.793-.907s.747-.43 1.22-.558A5.97 5.97 0 0 1 8.063 2c.504 0 .95.049 1.337.147.387.097.725.23 1.013.398.287.169.53.365.73.59a3.337 3.337 0 0 1 .772 1.486c.03.13.054.255.073.379h-1.276a2.393 2.393 0 0 0-.22-.615 2.315 2.315 0 0 0-.59-.724 2.467 2.467 0 0 0-.834-.44 3.376 3.376 0 0 0-1.005-.146 4.69 4.69 0 0 0-.958.097 2.77 2.77 0 0 0-.839.314 1.765 1.765 0 0 0-.597.566c-.152.233-.229.518-.229.854 0 .348.086.642.258.884.171.241.401.449.689.622.287.174.615.323.983.448s.749.247 1.142.367c.31.097.62.196.934.297a8.439 8.439 0 0 1 .973.38zm1.376 1c.175.217.315.466.418.746.105.285.158.612.158.98 0 .554-.104 1.041-.312 1.462-.207.42-.496.772-.867 1.054-.37.282-.81.495-1.32.64A6.12 6.12 0 0 1 8.205 14c-.543 0-1.071-.09-1.586-.273a4.44 4.44 0 0 1-1.374-.773 3.873 3.873 0 0 1-.97-1.217 3.695 3.695 0 0 1-.395-1.612h1.27c.028.407.122.78.282 1.12a2.835 2.835 0 0 0 1.581 1.465c.363.138.76.207 1.192.207.387 0 .758-.042 1.112-.126a2.85 2.85 0 0 0 .938-.399 2.01 2.01 0 0 0 .647-.708c.16-.29.241-.642.241-1.054 0-.337-.087-.623-.261-.86a2.333 2.333 0 0 0-.69-.61 4.651 4.651 0 0 0-.495-.257h2.099z"}}),i("path",{attrs:{d:"M3 7h10v1H3z"}})])])]),i("div",{class:["sizeSelect2","sizeSelect_color",{"sizeSelect-active":2===t.insertShow}],on:{mouseenter:function(e){return t.showTips(e,"字体颜色")},mouseleave:t.closeTips}},[i("div",{staticClass:"left-btn",on:{click:function(e){return t.textBaseStyleChange(7)}}},[t._m(0),i("div",{staticClass:"nowColor",style:"background-color:"+t.font_color+";"})]),i("div",{class:["right-btn",{"right-btn-active":2==t.insertShow}],on:{click:function(e){return t.handelListShow(2)}}}),i("div",{directives:[{name:"show",rawName:"v-show",value:2==t.insertShow,expression:"insertShow==2"}],staticClass:"sizeSelectList colorSelectList"},[i("div",{staticClass:"autoColor",on:{click:function(e){return t.selectColorChange("#000000")}}},[i("div",{staticClass:"color-item",staticStyle:{"background-color":"#000"}}),i("div",{staticClass:"autoColor_text"},[t._v("自动")])]),t._l(t.options_font_color,(function(e,a){return i("div",{key:a,staticClass:"colorSelect-group"},t._l(e,(function(e,a){return i("div",{key:a,class:["color-item",{"color-item-white":"#FFFFFF"==e.color},{"color-item-active":e.color==t.font_color}],style:"background-color:"+e.color+";",on:{click:function(i){return t.selectColorChange(e.color)}}},[e.color==t.font_color&&"#FFFFFF"!=e.color?i("svg",{staticClass:"icon",attrs:{height:"16","p-id":"4281",t:"1602210699073",version:"1.1",viewBox:"0 0 1024 1024",width:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M403.3 659.9c18-16.3 32.2-28.6 45.7-41.6 129.2-124.4 258.6-248.7 387.3-373.5 31.2-30.2 63.8-45.4 102-13.8 32 26.4 27.2 63.2-12.6 101.7C773.2 480.3 620.2 627.8 467.1 775c-48 46.1-74.1 46.4-121.2 1.5-83.1-79.4-165.3-159.8-248.5-239.1C66 507.5 50.1 476 82.8 439.1c27.4-30.9 65.6-26.4 105.5 11.9 71.3 68.5 141.9 137.8 215 208.9z",fill:"#FFFFFF","p-id":"4282"}})]):t._e(),e.color==t.font_color&&"#FFFFFF"==e.color?i("svg",{staticClass:"icon",attrs:{height:"16","p-id":"4281",t:"1602210699073",version:"1.1",viewBox:"0 0 1024 1024",width:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M403.3 659.9c18-16.3 32.2-28.6 45.7-41.6 129.2-124.4 258.6-248.7 387.3-373.5 31.2-30.2 63.8-45.4 102-13.8 32 26.4 27.2 63.2-12.6 101.7C773.2 480.3 620.2 627.8 467.1 775c-48 46.1-74.1 46.4-121.2 1.5-83.1-79.4-165.3-159.8-248.5-239.1C66 507.5 50.1 476 82.8 439.1c27.4-30.9 65.6-26.4 105.5 11.9 71.3 68.5 141.9 137.8 215 208.9z",fill:"#000000","p-id":"4282"}})]):t._e()])})),0)})),i("div",{staticStyle:{"line-height":"16px","font-size":"12px",color:"#767c85","margin-bottom":"12px","padding-left":"10px","margin-top":"15px"}},[t._v(" 标准色 ")]),i("div",t._l(t.options_font_color_bz,(function(e,a){return i("div",{key:a,staticClass:"colorSelect-group"},t._l(e,(function(e,a){return i("div",{key:a,class:["color-item",{"color-item-white":"#FFFFFF"==e.color},{"color-item-active":e.color==t.font_color}],style:"background-color:"+e.color+";",on:{click:function(i){return t.selectColorChange(e.color)}}},[e.color==t.font_color&&"#FFFFFF"!=e.color?i("svg",{staticClass:"icon",attrs:{height:"16","p-id":"4281",t:"1602210699073",version:"1.1",viewBox:"0 0 1024 1024",width:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M403.3 659.9c18-16.3 32.2-28.6 45.7-41.6 129.2-124.4 258.6-248.7 387.3-373.5 31.2-30.2 63.8-45.4 102-13.8 32 26.4 27.2 63.2-12.6 101.7C773.2 480.3 620.2 627.8 467.1 775c-48 46.1-74.1 46.4-121.2 1.5-83.1-79.4-165.3-159.8-248.5-239.1C66 507.5 50.1 476 82.8 439.1c27.4-30.9 65.6-26.4 105.5 11.9 71.3 68.5 141.9 137.8 215 208.9z",fill:"#FFFFFF","p-id":"4282"}})]):t._e(),e.color==t.font_color&&"#FFFFFF"==e.color?i("svg",{staticClass:"icon",attrs:{height:"16","p-id":"4281",t:"1602210699073",version:"1.1",viewBox:"0 0 1024 1024",width:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M403.3 659.9c18-16.3 32.2-28.6 45.7-41.6 129.2-124.4 258.6-248.7 387.3-373.5 31.2-30.2 63.8-45.4 102-13.8 32 26.4 27.2 63.2-12.6 101.7C773.2 480.3 620.2 627.8 467.1 775c-48 46.1-74.1 46.4-121.2 1.5-83.1-79.4-165.3-159.8-248.5-239.1C66 507.5 50.1 476 82.8 439.1c27.4-30.9 65.6-26.4 105.5 11.9 71.3 68.5 141.9 137.8 215 208.9z",fill:"#000000","p-id":"4282"}})]):t._e()])})),0)})),0)],2)]),i("div",{class:["sizeSelect2","sizeSelect_color",{"sizeSelect-active":5===t.insertShow}]},[i("div",{staticClass:"left-btn",on:{click:function(e){return t.selectColorChangeBg(t.bg_color)},mouseenter:function(e){return t.showTips(e,"突出显示")},mouseleave:t.closeTips}},[i("div",{staticClass:"color_a"},[i("svg",{attrs:{height:"16",width:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("g",{attrs:{fill:"#3D4757","fill-rule":"evenodd"}},[i("path",{attrs:{d:"M13.31 5h-1.92a2.203 2.203 0 0 0-.39-.034c-.135 0-.27.012-.402.034H10v.18c-.578.256-1 .714-1 1.214v1.928c0 .196.117.43.3.658v1.23a3.543 3.543 0 0 1-.3-.4V11H8V1h1v4.265C9 4.763 10 4 10.942 4c1.19 0 1.92.422 2.367 1zM2 6c-.03-.498-.175-2 2.5-2C7.11 4 7 5 7 6.902V11H5.984v-.993c.38.662-.115.993-1.484.993C2.708 11 2 9.931 2 9c0-1.428.447-2 2.5-2h1.484c0-1 .031-2-1.484-2-1.533 0-1.577.485-1.577 1H2zm2.5 2C3.601 8 3 7.768 3 9c0 1.31.438 1 1.5 1 .617 0 1.484-.665 1.484-1.847V8H4.5z"}}),i("path",{attrs:{d:"M13.085 6.316l-2.814 3a1 1 0 1 0 1.458 1.368l2.815-3a1 1 0 0 0-1.459-1.368z","fill-rule":"nonzero"}})])])]),i("div",{staticClass:"nowColor",style:"background-color:"+t.bg_color+";"})]),i("div",{class:["right-btn",{"right-btn-active":5==t.insertShow}],on:{click:function(e){return t.handelListShow(5)}}}),i("div",{directives:[{name:"show",rawName:"v-show",value:5==t.insertShow,expression:"insertShow==5"}],staticClass:"sizeSelectList colorSelectList"},[i("div",{staticClass:"autoColor",staticStyle:{"border-bottom":"1px solid #E2E6ED"},on:{click:function(e){return t.selectColorChangeBg("")}}},[i("div",{staticClass:"color-item",staticStyle:{border:"1px solid #CFCFCF"}}),i("div",{staticClass:"autoColor_text"},[t._v("无")])]),t._l(t.options_bg_color,(function(e,a){return i("div",{key:a,staticClass:"colorSelect-group"},t._l(e,(function(e,a){return i("div",{key:a,class:["color-item",{"color-item-white":"#FFFF00"===e.color},{"color-item-active":e.color===t.bg_color}],style:"background-color:"+e.color+";",on:{click:function(i){return t.selectColorChangeBg(e.color)}}},[e.color===t.bg_color&&"#FFFF00"!==e.color?i("svg",{staticClass:"icon",attrs:{height:"16","p-id":"4281",t:"1602210699073",version:"1.1",viewBox:"0 0 1024 1024",width:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M403.3 659.9c18-16.3 32.2-28.6 45.7-41.6 129.2-124.4 258.6-248.7 387.3-373.5 31.2-30.2 63.8-45.4 102-13.8 32 26.4 27.2 63.2-12.6 101.7C773.2 480.3 620.2 627.8 467.1 775c-48 46.1-74.1 46.4-121.2 1.5-83.1-79.4-165.3-159.8-248.5-239.1C66 507.5 50.1 476 82.8 439.1c27.4-30.9 65.6-26.4 105.5 11.9 71.3 68.5 141.9 137.8 215 208.9z",fill:"#FFFFFF","p-id":"4282"}})]):t._e(),e.color===t.bg_color&&"#FFFF00"===e.color?i("svg",{staticClass:"icon",attrs:{height:"16","p-id":"4281",t:"1602210699073",version:"1.1",viewBox:"0 0 1024 1024",width:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M403.3 659.9c18-16.3 32.2-28.6 45.7-41.6 129.2-124.4 258.6-248.7 387.3-373.5 31.2-30.2 63.8-45.4 102-13.8 32 26.4 27.2 63.2-12.6 101.7C773.2 480.3 620.2 627.8 467.1 775c-48 46.1-74.1 46.4-121.2 1.5-83.1-79.4-165.3-159.8-248.5-239.1C66 507.5 50.1 476 82.8 439.1c27.4-30.9 65.6-26.4 105.5 11.9 71.3 68.5 141.9 137.8 215 208.9z",fill:"#000000","p-id":"4282"}})]):t._e()])})),0)}))],2)]),i("div",{staticClass:"component-divider"}),i("div",{class:["sizeSelect sizeSelect_svg",{selected:t.nav4}],on:{click:function(e){return t.setLineStyle(1)},mouseenter:function(e){return t.showTips(e,"左对齐")},mouseleave:t.closeTips}},[i("svg",{attrs:{height:"16",width:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M2 13h12v1H2zm0-3h8v1H2zm0-3h12v1H2zm0-6h12v1H2zm0 3h8v1H2z",fill:"#3d4757","fill-rule":"evenodd"}})])]),i("div",{class:["sizeSelect sizeSelect_svg",{selected:t.nav5}],on:{click:function(e){return t.setLineStyle(2)},mouseenter:function(e){return t.showTips(e,"居中对齐")},mouseleave:t.closeTips}},[i("svg",{attrs:{height:"16",width:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M2 13h12v1H2v-1zm2-3h8v1H4v-1zM2 7h12v1H2V7zm0-6h12v1H2V1zm2 3h8v1H4V4z",fill:"#3D4757","fill-rule":"evenodd"}})])]),i("div",{class:["sizeSelect sizeSelect_svg",{selected:t.nav6}],on:{click:function(e){return t.setLineStyle(3)},mouseenter:function(e){return t.showTips(e,"右对齐")},mouseleave:t.closeTips}},[i("svg",{attrs:{height:"16",width:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M2 13h12v1H2v-1zm4-3h8v1H6v-1zM2 7h12v1H2V7zm0-6h12v1H2V1zm4 3h8v1H6V4z",fill:"#3D4757","fill-rule":"evenodd"}})])]),i("div",{class:["sizeSelect",{"sizeSelect-active":6===t.insertShow}],staticStyle:{"line-height":"24px",width:"35px"},on:{click:function(e){return t.setLineStyle(6)}}},[i("svg",{attrs:{height:"16",width:"16",xmlns:"http://www.w3.org/2000/svg"},on:{mouseenter:function(e){return t.showTips(e,"行间距")},mouseleave:t.closeTips}},[i("path",{attrs:{d:"M2 14h12v1H2v-1zm7-5h5v1H9V9zm0-3h5v1H9V6zM2 1h12v1H2V1zm2.5 3L7 7H2zm0 8L7 9H2z",fill:"#3D4757","fill-rule":"evenodd"}})]),i("div",{directives:[{name:"show",rawName:"v-show",value:6==t.insertShow,expression:"insertShow==6"}],staticClass:"sizeSelectList"},t._l(t.options_line_spacing,(function(e,a){return i("div",{key:a,staticClass:"sizeSelectItem",on:{click:function(i){return t.handelLineSpaceChange(e)}}},[i("span",[t._v(t._s(e))]),t.currentLineSpacing==e?i("svg",{attrs:{height:"16",width:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M6.586 9.828l5.657-5.656 1.414 1.414L8 11.243l-1.414 1.414-4.243-4.243L3.757 7l2.829 2.828z",fill:"#4991F2","fill-rule":"evenodd"}})]):t._e()])})),0)]),i("div",{staticClass:"sizeSelect sizeSelect_svg",on:{click:function(e){return t.setLineStyle(7)},mouseenter:function(e){return t.showTips(e,"减小缩进量")},mouseleave:t.closeTips}},[i("svg",{attrs:{height:"16",width:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M2 13h12v1H2v-1zm7-4h5v1H9V9zM2 4h12v1H2V4zm0-3h12v1H2V1zm3 8v1h2V9zm-3 .5L5 7v5z",fill:"#3D4757","fill-rule":"evenodd"}})])]),i("div",{staticClass:"sizeSelect sizeSelect_svg",on:{click:function(e){return t.setLineStyle(8)},mouseenter:function(e){return t.showTips(e,"增加缩进量")},mouseleave:t.closeTips}},[i("svg",{attrs:{height:"16",width:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M2 13h12v1H2v-1zm7-4h5v1H9V9zM2 4h12v1H2V4zm0-3h12v1H2V1zm0 8v1h2V9zm5 .5L4 7v5z",fill:"#3D4757","fill-rule":"evenodd"}})])]),i("div",{class:["sizeSelect2",{"sizeSelect-active-type2":t.nav_paragraph_bullet}],staticStyle:{"line-height":"24px",width:"35px"}},[i("div",{staticClass:"left-btn",on:{click:t.showNav7,mouseenter:function(e){return t.showTips(e,"项目符号")},mouseleave:t.closeTips}},[i("svg",{attrs:{height:"16",width:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("g",{attrs:{fill:"none","fill-rule":"evenodd",transform:"translate(0 -1)"}},[i("path",{attrs:{d:"M7 13h7v1H7zm0-5h7v1H7zm0-5h7v1H7z",fill:"#3D4757"}}),i("rect",{attrs:{height:"2",rx:"1",stroke:"#3D4757",width:"2",x:"2.5",y:"2.5"}}),i("rect",{attrs:{height:"2",rx:"1",stroke:"#3D4757",width:"2",x:"2.5",y:"7.5"}}),i("rect",{attrs:{height:"2",rx:"1",stroke:"#3D4757",width:"2",x:"2.5",y:"12.5"}})])])]),i("div",{class:["right-btn",{"right-btn-active":9==t.insertShow}],on:{click:function(e){return t.setLineStyle(9)},mouseenter:function(e){return t.showTips(e,"项目符号")},mouseleave:t.closeTips}}),i("div",{directives:[{name:"show",rawName:"v-show",value:9==t.insertShow,expression:"insertShow == 9"}],ref:"paragraph_bullet",staticClass:"sizeSelectList2",style:{height:"143px",width:"265px","text-align":"left"}},t._l(t.paragraph_bullet,(function(e,a){return i("div",{key:a,class:["sizeSelectListItem2",{item_active:t.currentParagraph.id==e.id}],on:{click:function(i){return t.setCurrentParagraphId(e,"bullet")}}},[0==a?i("div",{staticClass:"item_none item_nomal"},[t._v("无")]):i("div",{staticClass:"item_nomal"},[i("svg",{attrs:{height:"52",width:"48",xmlns:"http://www.w3.org/2000/svg"}},[i("g",[i("text",{attrs:{"font-size":"8px",x:"5",y:"15",fill:"#000000"}}),i("text",{attrs:{"font-size":"8px",x:"5",y:"29",fill:"#000000"}}),i("path",{attrs:{d:"M16 12h27v1H16zm0 14h27v1H16z",fill:"#767C85"}}),i("text",{attrs:{"font-size":"8px",x:"5",y:"43",fill:"#000000"}}),i("path",{attrs:{d:"M16 40h27v1H16z",fill:"#767C85"}})])])])])})),0)]),i("div",{class:["sizeSelect2",{"sizeSelect-active-type2":t.nav_paragraph_number}],staticStyle:{"line-height":"24px",width:"35px","margin-right":"4px"}},[i("div",{staticClass:"left-btn",on:{click:t.showNav8,mouseenter:function(e){return t.showTips(e,"编号格式")},mouseleave:t.closeTips}},[i("svg",{attrs:{height:"16",width:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("g",[i("path",{attrs:{d:"M7 12h7v1H7zm0-5h7v1H7zm0-5h7v1H7zM3 4V2H2V1h2v3h1v1H2V4h1z",fill:"#3D4757"}}),i("path",{attrs:{d:"M2 6h3v1H2V6zm0 3h3v1H2V9z",fill:"#4F4F4F"}}),i("path",{attrs:{d:"M4.5 6L5 7l-2.5 3L2 9z",fill:"#3D4757","fill-rule":"nonzero"}}),i("path",{attrs:{d:"M4 14l-1-2H2v-1h3v1H4l1 2v1H2v-1h2z",fill:"#3D4757"}})])])]),i("div",{class:["right-btn",{"right-btn-active":10==t.insertShow}],on:{click:function(e){return t.setLineStyle(10)},mouseenter:function(e){return t.showTips(e,"编号格式")},mouseleave:t.closeTips}}),i("div",{directives:[{name:"show",rawName:"v-show",value:10==t.insertShow,expression:"insertShow == 10"}],ref:"paragraph_number",staticClass:"sizeSelectList2",staticStyle:{height:"143px",width:"265px","text-align":"left"}},t._l(t.paragraph_number,(function(e,a){return i("div",{key:a,class:["sizeSelectListItem2",{item_active:t.currentParagraph.id==e.id||!t.currentParagraph.id&&!e.id}],on:{click:function(i){return t.setCurrentParagraphId(e,"number")}}},[0==a?i("div",{staticClass:"item_none item_nomal"},[t._v("无")]):i("div",{staticClass:"item_nomal"},[i("svg",{attrs:{height:"52",width:"48",xmlns:"http://www.w3.org/2000/svg"}},[i("g",[i("text",{attrs:{"font-size":"8px",x:"5",y:"15",fill:"#000000"}}),i("text",{attrs:{"font-size":"8px",x:"5",y:"29",fill:"#000000"}}),i("path",{attrs:{d:"M16 12h27v1H16zm0 14h27v1H16z",fill:"#767C85"}}),i("text",{attrs:{"font-size":"8px",x:"5",y:"43",fill:"#000000"}}),i("path",{attrs:{d:"M16 40h27v1H16z",fill:"#767C85"}})])])])])})),0)]),i("div",{staticClass:"component-divider"}),t.is_insert?i("div",{class:["sizeSelect",{"sizeSelect-active":3==t.insertShow}],on:{click:function(e){return t.handelListShow(3)}}},[i("div",{staticStyle:{height:"25px","line-height":"27px",display:"inline-block","vertical-align":"middle","margin-right":"9px"},on:{mouseenter:function(e){return t.showTips(e,"插入")},mouseleave:t.closeTips}},[i("svg",{staticStyle:{"vertical-align":"middle"},attrs:{height:"16",width:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("g",{attrs:{fill:"#3D4757","fill-rule":"evenodd"}},[i("path",{attrs:{d:"M8 1h6a1 1 0 0 1 1 1v11a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V7h1v6h12V2H8V1z"}}),i("path",{attrs:{d:"M4 8h8v1H4zm0 2h8v1H4zm1.301-7L3.784 1.494l.643-.607L7 3.47 4.476 6.168l-.695-.65L5.165 4H1V3h4.301z"}})])]),i("span",{staticStyle:{display:"inline-block","vertical-align":"middle","font-size":"12px",color:"#3D4757","margin-left":"5px"}},[t._v("插入")])]),i("div",{directives:[{name:"show",rawName:"v-show",value:3==t.insertShow,expression:"insertShow==3"}],staticClass:"showlist"},[t._l(t.insertData,(function(e,a){return i("div",{key:a,class:["list",{active:t.hoverIndex==a+1},{disabled:t.insertDisable&&0==a}],on:{click:function(e){return t.insertClick(a)},mouseenter:function(e){return t.handelHover(a+1)}}},[i("div",{staticStyle:{padding:"0 4px","font-size":"12px",color:"#3d4757",display:"flex","align-items":"center","justify-content":"center"}},[i("div",{staticStyle:{display:"inline-block","margin-right":"10px"},domProps:{innerHTML:t._s(e.svg)}}),t._v(" "+t._s(e.text)+" "),i("svg",{staticStyle:{"margin-left":"15px"},attrs:{width:"16",height:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("g",{attrs:{fill:"#767C85","fill-rule":"evenodd"}},[i("path",{attrs:{d:"M7 12.243l-.707-.707 4.243-4.243.707.707z"}}),i("path",{attrs:{d:"M6.293 4.464L7 3.757 11.243 8l-.707.707z"}})])])])])})),i("div",{directives:[{name:"show",rawName:"v-show",value:1==t.hoverIndex,expression:"hoverIndex==1"}],staticClass:"tableSelect",on:{mousedown:t.insertTable,mouseenter:function(e){return t.handelHover(1)},mouseleave:function(e){return t.handelHover(0)}}},[i("div",{staticStyle:{padding:"14px 16px",width:"100%",height:"100%",position:"relative"}},[i("div",{staticClass:"shadows",on:{mousemove:t.tableCellMove}}),i("div",{staticClass:"titlemsg"},[t.tableSize.x&&t.tableSize.y?i("span",[t._v(t._s(t.tableSize.x)+"x"+t._s(t.tableSize.y)+" 表格")]):i("span",[t._v(" 插入表格 ")])]),i("div",{staticClass:"cellBox"},t._l(t.tableCell,(function(e,a){return i("div",{key:a,class:["cellRow",{activeX:a<t.nowCellY}]},t._l(t.tableCell,(function(e,a){return i("div",{key:a,class:["cellBaseStyle",{activeY:a<t.nowCellX}]})})),0)})),0)])])],2)]):t._e(),t.is_print?i("div",{staticClass:"sizeSelect sizeSelect_svg",on:{click:function(e){return t.setLineStyle(13)},mouseenter:function(e){return t.showTips(e,"打印")},mouseleave:t.closeTips}},[i("svg",{attrs:{height:"16",width:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("g",{attrs:{fill:"#3D4757","fill-rule":"evenodd"}},[i("path",{attrs:{d:"M12 4h-1V2H5v2H4V2a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2zm0 5v4a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V9h1v4h6V9h1z"}}),i("path",{attrs:{d:"M12 12v-1h2V5H2v6h2v1H2a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1h-2z"}}),i("path",{attrs:{d:"M3 8h10v1H3zm8-2h2v1h-2z"}})])])]):t._e(),t.is_import_word&&t.import_url?i("div",{staticClass:"sizeSelect sizeSelect_svg",on:{click:function(e){return t.setLineStyle(15)},mouseenter:function(e){return t.showTips(e,"导入Word")},mouseleave:t.closeTips}},[i("svg-icon",{staticClass:"icon-style",attrs:{"svg-name":"v-import-word",height:"16"}})],1):t._e(),t.is_export_word?i("div",{staticClass:"sizeSelect sizeSelect_svg",on:{click:function(e){return t.setLineStyle(14)},mouseenter:function(e){return t.showTips(e,"导出WORD")},mouseleave:t.closeTips}},[i("svg-icon",{staticClass:"icon-style",attrs:{"svg-name":"v-export-word",height:"16"}})],1):t._e(),t.is_export_pdf?i("div",{staticClass:"sizeSelect sizeSelect_svg",on:{click:function(e){return t.setLineStyle(15)},mouseenter:function(e){return t.showTips(e,"导出PDF")},mouseleave:t.closeTips}},[i("svg-icon",{staticClass:"icon-style",attrs:{"svg-name":"v-export-pdf",height:"16"}})],1):t._e()]),i("div",{ref:"scrollSvgBox",staticClass:"svgBox-min"},[i("div",{ref:"pageContent",staticClass:"pageContent",style:t.getPageContentStyle(),attrs:{id:"pageContent"}},t._l(t.show_page_idx,(function(e){return i("div",{key:e,ref:"canvasUnit",refInFor:!0,staticClass:"canvas-unit",style:t.getPageStyle(e),attrs:{"data-index":e},on:{mousemove:function(i){return t.onMouseMove(i,e)},onselectstart:!1}},[i("svg",{attrs:{"data-index":e,height:t.page_height+"px",width:t.page_width+"px",id:"svg-page",overflow:"hidden",version:"1.1",viewBox:"0 0 794 1123",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},on:{mousedown:function(i){return t.onMouseDown(i,e)},mouseup:function(i){return t.onMouseUp(i,e)}}},[i("g",{staticClass:"printHide",attrs:{id:"header-footer"}},[i("g",[i("path",{attrs:{d:t.path1,fill:"none",stroke:"grey","stroke-dasharray":"","stroke-width":"0.5"}}),i("path",{attrs:{d:t.path2,fill:"none",stroke:"grey","stroke-dasharray":"","stroke-width":"0.5"}}),i("path",{attrs:{d:t.path3,fill:"none",stroke:"grey","stroke-dasharray":"","stroke-width":"0.5"}}),i("path",{attrs:{d:t.path4,fill:"none",stroke:"grey","stroke-dasharray":"","stroke-width":"0.5"}})]),t.isEditHead?i("path",{attrs:{d:t.path_header,fill:"none",stroke:"#eeeeee","stroke-dasharray":"6,4","stroke-width":"2"}}):t._e(),t.isEditHead?i("path",{attrs:{d:t.path_footer,fill:"none",stroke:"#eeeeee","stroke-dasharray":"6,4","stroke-width":"2"}}):t._e()]),i("g",[i("text",{attrs:{x:t.page_width/2-10,y:t.page_height-t.bottom_margin+36,"font-size":"14px","font-family":"Arial"}},[t._v("第"+t._s(e+1)+"页 ")])]),i("g",[i("g",{ref:"mainContent",refInFor:!0,attrs:{fill:"#000000","font-family":"宋体","font-style":"normal","font-weight":"normal",id:"main-content"}}),i("g",{attrs:{id:"colorBlock"}}),i("g",{attrs:{id:"rectParent"}}),i("g",{attrs:{id:"table-border"},on:{mousemove:function(e){return t.tableMousemove(e)}}}),i("g",{ref:"selection",refInFor:!0,attrs:{id:"selection"}}),i("g",{ref:"underLineDom",refInFor:!0,attrs:{id:"underLine",stroke:"black"}})])]),t.showTableSelectLine?i("div",{staticClass:"table-select-line",style:t.tableSelectLine,attrs:{id:"tableLine"},on:{mousedown:function(e){return e.stopPropagation(),t.tableSelectClick(e)},mouseleave:t.clearTableSelectLine}}):t._e(),i("input",{directives:[{name:"show",rawName:"v-show",value:t.cursor_page_idx==e,expression:"cursor_page_idx == page_idx"}],ref:"inputdom",refInFor:!0,staticClass:"virtual-input",attrs:{type:"text",page:e,nowScale:t.nowScale}}),i("div",{directives:[{name:"show",rawName:"v-show",value:t.cursor_page_idx==e,expression:"cursor_page_idx == page_idx"}],ref:"currentPlace",refInFor:!0,staticClass:"currentPlace",attrs:{id:"currentPlace",page:e,nowScale:t.nowScale}})])})),0)]),i("el-dialog",{attrs:{"before-close":t.handleClose,visible:t.dialogVisible,title:"提示",width:"30%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("div",{staticClass:"input_div"},[i("span",[t._v("文本")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.text_a,expression:"text_a"}],staticClass:"input-style",attrs:{type:"text"},domProps:{value:t.text_a},on:{input:function(e){e.target.composing||(t.text_a=e.target.value)}}})]),i("div",{staticClass:"input_div"},[i("span",[t._v("链接")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.url_a,expression:"url_a"}],staticClass:"input-style",attrs:{type:"text"},domProps:{value:t.url_a},on:{input:function(e){e.target.composing||(t.url_a=e.target.value)}}})]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.handleClose}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.handleClose(1)}}},[t._v("确 定")])],1)]),i("div",{staticClass:"loads",style:{display:t.dialogVisible?"block":"none"}}),i("input",{ref:"upImg",staticStyle:{display:"none"},attrs:{accept:"image/*",type:"file"},on:{change:t.submitImg}}),i("input",{ref:"upDoc",staticStyle:{display:"none"},attrs:{accept:".docx",type:"file"},on:{change:t.submitDoc}}),t.selectImgObj?i("div",{ref:"imgControl",staticClass:"img-control",style:t.setImgControlStyle()},[i("div",{staticClass:"img-border",style:t.setImgStyle(),attrs:{"data-index":t.selectImgObj.page_idx},on:{mousedown:function(e){return t.onAllowImgMovePosition(e)}}},[i("div",{staticClass:"handles handle-1",on:{mousedown:function(e){return e.stopPropagation(),t.startMove(e,1)}}}),i("div",{staticClass:"handles handle-2",on:{mousedown:function(e){return e.stopPropagation(),t.startMove(e,2)}}}),i("div",{staticClass:"handles handle-3",on:{mousedown:function(e){return e.stopPropagation(),t.startMove(e,3)}}}),i("div",{staticClass:"handles handle-4",on:{mousedown:function(e){return e.stopPropagation(),t.startMove(e,4)}}}),i("div",{staticClass:"handles handle-5",on:{mousedown:function(e){return e.stopPropagation(),t.startMove(e,5)}}}),i("div",{staticClass:"handles handle-6",on:{mousedown:function(e){return e.stopPropagation(),t.startMove(e,6)}}}),i("div",{staticClass:"handles handle-7",on:{mousedown:function(e){return e.stopPropagation(),t.startMove(e,7)}}}),i("div",{staticClass:"handles handle-8",on:{mousedown:function(e){return e.stopPropagation(),t.startMove(e,8)}}}),t.allowImgMove||t.allowImgMovePosition?i("div",{staticClass:"img-shadow",style:t.shadowStyle},[i("img",{staticStyle:{width:"100%",height:"100%","object-fit":"fill"},attrs:{src:t.selectImgObj.href,alt:"",draggable:"false"}})]):t._e()])]):t._e(),i("span",{ref:"textWith",attrs:{id:"getWidthDom"}}),i("div",{ref:"tableMoveLine",style:t.tableMoveLineStyle,attrs:{id:"tableMoveLine"}}),i("div",{ref:"titleTips",attrs:{id:"titleTips"}}),i("div",{directives:[{name:"show",rawName:"v-show",value:t.tableMenu.show,expression:"tableMenu.show"}],ref:"menu_table",attrs:{id:"menu_table"}},[t.tableMenu.tableText?i("div",{staticStyle:{overflow:"visible"}},t._l(t.tableMenu.tableText,(function(e,a){return i("div",{key:a,class:["menu_table_li",{disabled:e.disable}],on:{mouseenter:function(i){return t.setTableMenuList(e.type)},mouseleave:function(e){return t.setTableMenuList(0)},click:function(i){return t.tableMenuTextClick(e)}}},[0===a?i("svg",{staticStyle:{"padding-right":"10px"},attrs:{width:"16",height:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("g",{attrs:{fill:"none","fill-rule":"evenodd"}},[i("path",{attrs:{stroke:"#3D4757",d:"M8.5 5.5h6v4h-6z"}}),i("path",{attrs:{fill:"#3D4757",d:"M4 7v1h2V7zm-3 .5L4 5v5zM1 1h12v1H1zm0 12h12v1H1z"}})])]):t._e(),1===a?i("svg",{staticStyle:{"padding-right":"10px"},attrs:{width:"16",height:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("g",{attrs:{fill:"none","fill-rule":"evenodd"}},[i("path",{attrs:{stroke:"#929AA8",d:"M8.5 6.5h6v2h-6z"}}),i("path",{attrs:{fill:"#3D4757",d:"M2 12h11v1H2zM2 2h11v1H2zm.63 3L7 9.35l-.635.65L2 5.63z"}}),i("path",{attrs:{fill:"#3D4757",d:"M2 9.363L6.355 5 7 5.707 2.695 10z"}})])]):t._e(),2===a?i("svg",{staticStyle:{"padding-right":"10px"},attrs:{width:"16",height:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("g",{attrs:{fill:"#3D4757","fill-rule":"evenodd"}},[i("path",{attrs:{d:"M6 1v1H2v11h4v1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h4zm3 0h4a1 1 0 0 1 1 1v11a1 1 0 0 1-1 1H9v-1h4V2H9V1z"}}),i("path",{attrs:{"fill-rule":"nonzero",d:"M6 1h1v4H6zm2 0h1v4H8z"}}),i("path",{attrs:{d:"M8 7.5L10 6v3zm-1 0L5 6v3z"}}),i("path",{attrs:{d:"M9 7h3v1H9zM3 7h3v1H3z"}}),i("path",{attrs:{"fill-rule":"nonzero",d:"M8 10h1v4H8zm-2 0h1v4H6z"}})])]):t._e(),i("span",[t._v(t._s(e.name))]),e.hasList?i("svg",{staticStyle:{position:"absolute",right:"10px"},attrs:{width:"16",height:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("g",{attrs:{fill:"#767C85","fill-rule":"evenodd"}},[i("path",{attrs:{d:"M7 12.243l-.707-.707 4.243-4.243.707.707z"}}),i("path",{attrs:{d:"M6.293 4.464L7 3.757 11.243 8l-.707.707z"}})])]):t._e(),i("div",{staticClass:"list_box_parent"},[e.hasList&&1==e.type?i("div",{class:["list_box",{list_box_active:t.tableMenuListType==e.type}]},[i("div",{staticClass:"list_box_item",on:{click:function(e){return t.menuOpera(1)}}},[i("svg",{attrs:{width:"16",height:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("g",{attrs:{fill:"none","fill-rule":"evenodd"}},[i("path",{attrs:{fill:"#3D4757",d:"M8 5H7v3h1zm-.5-3L10 5H5z"}}),i("rect",{attrs:{stroke:"#3D4757",x:"1.5",y:"10.5",width:"12",height:"3",rx:"1"}})])]),i("span",[t._v("上方插入"+t._s(t.tableMenu.tableRow.row)+"行")])]),i("div",{staticClass:"list_box_item",on:{click:function(e){return t.menuOpera(2)}}},[i("svg",{attrs:{width:"16",height:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("g",{attrs:{fill:"none","fill-rule":"evenodd"}},[i("path",{attrs:{fill:"#3D4757",d:"M7 11h1V8H7zm.5 3L5 11h5z"}}),i("rect",{attrs:{stroke:"#3D4757",x:"1.5",y:"2.5",width:"12",height:"3",rx:"1"}})])]),i("span",[t._v("下方插入"+t._s(t.tableMenu.tableRow.row)+"行")])]),i("div",{staticClass:"list_box_item",on:{click:function(e){return t.menuOpera(3)}}},[i("svg",{attrs:{width:"16",height:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("g",{attrs:{fill:"none","fill-rule":"evenodd"}},[i("path",{attrs:{fill:"#3D4757",d:"M11 7v1h3V7zm-3 .5L11 5v5z"}}),i("rect",{attrs:{stroke:"#3D4757",transform:"rotate(90 4 7.5)",x:"-2",y:"6",width:"12",height:"3",rx:"1"}})])]),i("span",[t._v("左侧插入"+t._s(t.tableMenu.tableRow.column)+"列")])]),i("div",{staticClass:"list_box_item",on:{click:function(e){return t.menuOpera(4)}}},[i("svg",{attrs:{width:"16",height:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("g",{attrs:{fill:"none","fill-rule":"evenodd"}},[i("path",{attrs:{fill:"#3D4757",d:"M5 8V7H2v1zm3-.5L5 10V5z"}}),i("rect",{attrs:{stroke:"#3D4757",transform:"rotate(90 12 7.5)",x:"6",y:"6",width:"12",height:"3",rx:"1"}})])]),i("span",[t._v("右侧插入"+t._s(t.tableMenu.tableRow.column)+"列")])])]):t._e()]),i("div",{staticClass:"list_box_parent"},[e.hasList&&2==e.type?i("div",{class:["list_box",{list_box_active:t.tableMenuListType==e.type}]},[i("div",{staticClass:"list_box_item",on:{click:function(e){return t.menuOpera(5)}}},[i("svg",{attrs:{width:"16",height:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("g",{attrs:{fill:"none","fill-rule":"evenodd"}},[i("path",{attrs:{stroke:"#929AA8",d:"M8.5 5.5h6v4h-6z"}}),i("path",{attrs:{fill:"#3D4757",d:"M1 13h12v1H1zM1 1h12v1H1zm0 4h1v1H1zm1 1h1v1H2zm1 1h1v1H3zm1-1h1v1H4zm1-1h1v1H5zM4 8h1v1H4zM2 8h1v1H2zm3 1h1v1H5zM1 9h1v1H1z"}})])]),i("span",[t._v("删除"+t._s(t.tableMenu.tableRow.row)+"行")])]),i("div",{staticClass:"list_box_item",on:{click:function(e){return t.menuOpera(6)}}},[i("svg",{attrs:{width:"16",height:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("g",{attrs:{fill:"none","fill-rule":"evenodd"}},[i("path",{attrs:{stroke:"#929AA8",d:"M5.5 7.5v-6h4v6z"}}),i("path",{attrs:{fill:"#3D4757",d:"M13 15V3h1v12zM1 15V3h1v12zm4 0v-1h1v1zm1-1v-1h1v1zm1-1v-1h1v1zm-1-1v-1h1v1zm-1-1v-1h1v1zm3 1v-1h1v1zm0 2v-1h1v1zm1-3v-1h1v1zm0 4v-1h1v1z"}})])]),i("span",[t._v("删除"+t._s(t.tableMenu.tableRow.column)+"列")])]),i("div",{staticClass:"list_box_item",on:{click:function(e){return t.menuOpera(7)}}},[i("svg",{attrs:{width:"16",height:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("g",{attrs:{fill:"#3D4757","fill-rule":"evenodd"}},[i("path",{attrs:{d:"M14 13h-1v-3H2v3H1v-3a1 1 0 0 1 1-1h11a1 1 0 0 1 1 1v3z","fill-rule":"nonzero"}}),i("path",{attrs:{d:"M5.625 2L10 6.375 9.375 7 5 2.625z"}}),i("path",{attrs:{d:"M5 6.375L9.375 2l.625.625L5.625 7z"}})])]),i("span",[t._v("删除整个表格")])])]):t._e()])])})),0):t._e()]),i("div",{staticClass:"footerShow",style:{width:t.width||"100%"}},[i("div",{staticClass:"left"},[i("span",[t._v("页码: "+t._s(t.current_page_idx+1))]),i("span",[t._v("页面: "+t._s(t.current_page_idx+1)+" / "+t._s(t.page_number))])]),i("div",{staticClass:"right"},[i("div",{staticClass:"right_del",on:{click:function(e){return t.changeScale(1)}}},[i("svg",{attrs:{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M3 7h10v2H3z",fill:"#636363","fill-rule":"evenodd"}})])]),i("div",{staticStyle:{"font-size":"12px"}},[t._v(t._s(t.nowScale)+"%")]),i("div",{staticClass:"right_add",on:{click:function(e){return t.changeScale(2)}}},[i("svg",{attrs:{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M7 7V3h2v4h4v2H9v4H7V9H3V7h4z",fill:"#636363","fill-rule":"evenodd"}})])])])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.showSearchType,expression:"showSearchType"}],staticClass:"searchBox",style:{left:t.searchPlace.left+"px",top:t.searchPlace.top+"px"}},[i("div",{staticClass:"move_box"},[i("div",{staticClass:"search_title"},[t._v("查找和替换")]),i("div",{staticClass:"move_bg"}),i("div",{staticClass:"btn_close",on:{click:function(e){t.showSearchType=null}}},[t._v("X")])]),i("div",{staticClass:"search_input"},[i("div",{staticClass:"click_btn"},[t._v("查找")]),i("div",{staticClass:"input_box"},[i("div",{staticClass:"click_btn_s"},[i("svg",{attrs:{width:"16",height:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("g",{attrs:{fill:"none"}},[i("circle",{attrs:{stroke:"#3D4757",cx:"6",cy:"6",r:"4.5"}}),i("path",{attrs:{d:"M10.061 10.968L8.707 9.414l.707-.707 1.514 1.457.435-.404 2.632 2.462a1.154 1.154 0 0 1 .05 1.635 1.184 1.184 0 0 1-1.655.064l-2.788-2.527.46-.426z",fill:"#3D4757"}})])])]),i("input",{staticClass:"input_dom",attrs:{type:"text",placeholder:"输入查找内容"}})])])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.showPrint,expression:"showPrint"}],staticClass:"printSetting"},[i("div",{ref:"contentBox",staticClass:"contentBox"},[i("div",{staticClass:"top_move"},[i("div",{staticClass:"header_title"},[t._v("打印设置")]),i("div",{staticClass:"header_close",on:{click:t.cancelPrint}},[i("svg",{attrs:{width:"16",height:"16",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M8.9 8.192l4.242 4.243-.707.707L8.192 8.9 3.95 13.142l-.707-.707 4.242-4.243L3.243 3.95l.707-.707 4.242 4.242 4.243-4.242.707.707L8.9 8.192z",fill:"#6A6A6A","fill-rule":"evenodd"}})])])]),i("div",{staticClass:"dialog_content"},[i("div",{staticClass:"dialog_content_title"},[t._v("打印范围")]),i("div",{staticClass:"check_group"},[t._l(t.printList,(function(e,a){return i("div",{key:a,class:["check_icon",{checked:t.printType==e.value}],on:{click:function(i){return t.changePrintType(e)}}},[i("div",{staticClass:"radio-icon"}),i("div",{staticClass:"radio-text"},[t._v(t._s(e.label))])])})),i("div",{staticClass:"range"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.print_value,expression:"print_value"}],attrs:{type:"text",disabled:3!=t.printType,placeholder:"例如：1-3，5，7-9"},domProps:{value:t.print_value},on:{input:[function(e){e.target.composing||(t.print_value=e.target.value)},function(e){t.err_text=""}]}})])],2)]),i("div",{staticClass:"errorMsg"},[t._v(t._s(t.err_text))]),i("div",{staticClass:"dialog-foot"},[i("div",{staticClass:"component-text-btn cancel-btn",on:{click:t.cancelPrint}},[t._v("取消")]),i("div",{staticClass:"component-text-btn confirm-btn",on:{click:t.submitPrint}},[t._v("下一步")])])])]),i("div",{attrs:{id:"iframeDom"}})],1)},n=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"color_a"},[i("span",[t._v("A")])])}],r=i("b85c"),l=(i("159b"),i("ac1f"),i("1276"),i("07ac"),i("99af"),i("cc71"),i("c5d0"),i("a434"),i("a9e3"),i("d3b7"),i("b065")),s=i("b775"),o=(i("fb6a"),i("4d63"),i("25f0"),i("cf45")),h=i("d4ec"),d=i("bee2"),c=i("e27d"),g=i("2909");function p(t,e){return p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},p(t,e)}function u(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}function _(t){return _=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},_(t)}function v(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}var f=i("7037"),w=i.n(f);function m(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function x(t,e){if(e&&("object"===w()(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return m(t)}function b(t){var e=v();return function(){var i,a=_(t);if(e){var n=_(this).constructor;i=Reflect.construct(a,arguments,n)}else i=a.apply(this,arguments);return x(this,i)}}i("b64b"),i("b680"),i("a630"),i("3ca3");var y=function(){function t(e,i){Object(h["a"])(this,t),this.x=e,this.y=i}return Object(d["a"])(t,[{key:"copy",value:function(e){return e||(e=new t),e.x=this.x,e.y=this.y,e}}]),t}(),k=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;Object(h["a"])(this,t),c["d"].g_id_count++,this.id="cell-"+c["d"].g_id_count,this.page_idx=e,this.paragraph=n,this.node=r,this.begin=i||{},this.end=a||{},this.text_begin=l||{},this.text_end=s||{},this.bg_begin=i?i.copy():{},this.bg_end=a?a.copy():{},this.idx=o,this.run_idx=d,this.latter=!0,this.cursor_use_next=!1}return Object(d["a"])(t,[{key:"check",value:function(t){return this.begin.x<=t.x&&t.x<=this.end.x&&this.begin.y<=t.y&&t.y<=this.end.y}},{key:"isRange",value:function(t,e,i){return t===this.page_idx&&this.check(new y(e,i))}},{key:"compare",value:function(t){return this.begin.x===t.begin.x&&this.begin.y===t.begin.y&&this.end.x===t.end.x&&this.end.y===t.end.y}},{key:"compareCursor",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return e===i?this.compare(t):e?this.end.x===t.begin.x&&this.begin.y===t.begin.y&&this.end.y===t.end.y:!!i&&(t.end.x===this.begin.x&&t.begin.y===this.begin.y&&t.end.y===this.end.y)}},{key:"copy",value:function(e){var i,a,n,r,l,s,o,h;return e||(e=new t),e.begin.x=this.begin.x,e.begin.y=this.begin.y,e.end.x=this.end.x,e.end.y=this.end.y,e.page_idx=this.page_idx,e.paragraph=this.paragraph,e.node=this.node,e.idx=this.idx,e.latter=this.latter,e.text_begin.x=null===(i=this.text_begin)||void 0===i?void 0:i.x,e.text_begin.y=null===(a=this.text_begin)||void 0===a?void 0:a.y,e.text_end.x=null===(n=this.text_end)||void 0===n?void 0:n.x,e.text_end.y=null===(r=this.text_end)||void 0===r?void 0:r.y,e.bg_begin.x=null===(l=this.bg_begin)||void 0===l?void 0:l.x,e.bg_begin.y=null===(s=this.bg_begin)||void 0===s?void 0:s.y,e.bg_end.x=null===(o=this.bg_end)||void 0===o?void 0:o.x,e.bg_end.y=null===(h=this.bg_end)||void 0===h?void 0:h.y,e}}]),t}(),C=function(t){u(i,t);var e=b(i);function i(t,a){var n;return Object(h["a"])(this,i),n=e.call(this),c["d"].g_id_count++,n.id="table-cell-"+c["d"].g_id_count,n.row_idx=t,n.col_idx=a,n.begin=null,n.end=null,n.page_idx=null,n.select=!1,n}return i}(k),S=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(h["a"])(this,t),this.row_height=e,this.char_height=i,this.begin_x=a},z=i("5fa0"),L=(i("5319"),{getPageDom:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#main-content",i=this.getPageDom.dom||(this.getPageDom.dom=document.getElementById("pageContent")),a=this.getPageDom.page_dom||(this.getPageDom.page_dom={});if(a.hasOwnProperty(e)||(a[e]={}),a[e].hasOwnProperty(t))return a[e][t];var n,l=null,s=(null===i||void 0===i?void 0:i.children)||[],o=Object(r["a"])(s);try{for(o.s();!(n=o.n()).done;){var h=n.value;if(h.dataset.index==t){l=h;break}}}catch(d){o.e(d)}finally{o.f()}return l?(a[e][t]=l.querySelector(e),a[e][t]):null},drawText:function(t,e){var i=t.text,a=t.position,n=t.page_idx,r=this.getPageDom(n);if(r){var l,s,o,h,d=document.createElementNS("http://www.w3.org/2000/svg","text");if("&#8629"===i)d.setAttribute("class","printHide"),d.setAttribute("fill","#52AFFE");else if(null!==t&&void 0!==t&&null!==(l=t.font)&&void 0!==l&&l.color){var c,g,p;d.setAttribute("fill",null===(c=t.font)||void 0===c?void 0:c.color),"bold"===(null===t||void 0===t||null===(g=t.font)||void 0===g?void 0:g.weight)&&d.setAttribute("font-weight","bold"),"italic"===(null===t||void 0===t||null===(p=t.font)||void 0===p?void 0:p.style)&&d.setAttribute("font-style","italic")}d.setAttribute("x",a.x),d.setAttribute("y",a.y),d.innerHTML=i.replace(/ /g,"&emsp;"),d.setAttribute("font-size",((null===t||void 0===t||null===(s=t.font)||void 0===s?void 0:s.size)||14)+"px"),null!==t&&void 0!==t&&null!==(o=t.font)&&void 0!==o&&o.family?d.setAttribute("font-family",(null===t||void 0===t?void 0:t.font.family)+" Arial"):d.setAttribute("font-family","Arial"),null!==t&&void 0!==t&&t.id&&d.setAttribute("id",t.id),r.appendChild(d),null!==t&&void 0!==t&&null!==(h=t.font)&&void 0!==h&&h.decoration&&e&&this.drawLine(r,t,e)}},drawMultiLineText:function(t){var e,i=Object(r["a"])(t.row||[]);try{for(i.s();!(e=i.n()).done;){var a=e.value;this.drawText(a,t)}}catch(n){i.e(n)}finally{i.f()}},drawTable:function(t){var e=t.position,i=t.page_idx,a={};a[i]="";var n="",l=null,s=this;function o(t,e,r,o,h){var d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;n=s.createPath(e,r+.5,1)+s.createPath(o,h+.5),a[t]+='<path \nfill="none" n_b_x="'.concat(e,'" n_b_y="').concat(r,'" n_e_x="').concat(o,'" n_e_y="').concat(h,'"  \nid="').concat(null===d||void 0===d?void 0:d.id,'" stroke="#000000" stroke-dasharray d="').concat(n,'"></path>'),c["a"]&&(l=s.getPageDom(i,"#table-border"),l&&(l.innerHTML+=a[i]))}var h,d=Object(r["a"])(e);try{for(d.s();!(h=d.n()).done;){var g=h.value;o(g.page_idx,g.begin.x,g.begin.y,g.end.x,g.end.y)}}catch(p){d.e(p)}finally{d.f()}for(i in a)l=this.getPageDom(Number(i),"#table-border"),l&&(l.innerHTML+=a[i])},drawImage:function(t,e){var i="";if(e.href?i=e.href:e.data&&(i=-1==e.data.indexOf("data:image/png;base64")?"data:image/png;base64,"+e.data:e.data),i){var a=this.getPageDom(t,"#svg-page"),n=document.createElementNS("http://www.w3.org/2000/svg","g");e.id&&n.setAttribute("id",e.id),n.setAttribute("class","wordImg"),n.setAttribute("transform","translate(".concat(e.position.x,",").concat(e.position.y+c["d"].g_word_page.top_margin,")"));var r='<image width="'.concat(e.width,'" height="').concat(e.height,'" xlink:href="').concat(i,'" data-index="').concat(t+1,'" preserveAspectRatio="none"></image>');n.innerHTML=r,a&&a.append(n)}},drawCursor:function(t,e,i){var a=this.getPageDom(t,"#currentPlace");if(a){var n=Number(a.getAttribute("nowScale")||100);a.style.top=e.y*n/100+"px",a.style.left=e.x*n/100+"px";var r=(i.y-e.y)*n/100;a.style.height=r+"px",this.drawInput(t,e.y,e.x)}},drawRect:function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"rgb(0,0,0)",n=this.getPageDom(t,"#rectParent"),r='<rect x="'.concat(e.x,'" y="').concat(e.y,'" width="').concat(i.x-e.x,'" height="').concat(i.y-e.y,'" style="fill:rgb(255,255,255);fill-opacity:0;stroke-width:1;\n     stroke:').concat(a,'"/></rect>');n&&(n.innerHTML+=r)},drawInput:function(t,e,i){var a=this.getPageDom(t,".virtual-input");a.style.top=e+"px",a.style.left=i+"px"},drawBackground:function(t,e){var i=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"rgb(85,165,255)";if(e.length>0){var n="";e.forEach((function(t,e){var r=i.createPath(t.start.x,t.start.y,1)+i.createPath(t.start.x,t.end.y)+i.createPath(t.end.x,t.end.y)+i.createPath(t.end.x,t.start.y);n+='<path fill="'.concat(a,'" stroke="none" paint-order="stroke fill markers" d="').concat(r,'" fill-opacity="0.5"></path>')}));var r=this.getPageDom(t,"#selection");n&&r&&(r.innerHTML+=n)}},drawTextBackground:function(t,e){var i=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"rgb(85,165,255)";if(e.length>0){var n="";e.forEach((function(t,e){if(t.start&&t.end){var r=i.createPath(t.start.x,t.start.y,1)+i.createPath(t.start.x,t.end.y)+i.createPath(t.end.x,t.end.y)+i.createPath(t.end.x,t.start.y);n+='<path fill="'.concat(a,'" stroke="none" paint-order="stroke fill markers" d="').concat(r,'" fill-opacity="0.5"></path>')}}));var r=this.getPageDom(t,"#colorBlock");n&&r&&(r.innerHTML+=n)}},drawLine:function(t,e,i){var a=null,n=null,r=null,l=null,s=0;e.begin&&e.end&&e.font.decoration&&(e.font.decoration.indexOf("underline")>-1&&(n=e.begin.x,l=e.end.x,s=(e.end.y-e.begin.y-i.char_height)/2,r=e.end.y-s,a=this.createPath(n,r,!0)+this.createPath(l,r),a='<path fill="none" stroke="#000" d="'.concat(a,'"  stroke-width="1"></path>'),t.innerHTML+=a),e.font.decoration.indexOf("line-through")>-1&&(n=e.begin.x,l=e.end.x,s=(e.end.y-e.begin.y-i.char_height)/2,r=e.end.y-s-i.char_height/2,a=this.createPath(n,r,!0)+this.createPath(l,r),a='<path fill="none" stroke="#000" d="'.concat(a,'"  stroke-width="1"></path>'),t.innerHTML+=a))},drawPage:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e=null===e?t:e;var i=c["d"].g_word_page,a=c["d"].g_seq_paragraph,n=a.getFirstNode();while(n){if(null===n.page_idx||n.page_idx>e)return;(n.page_idx>=t&&n.page_idx_end<=e||n.page_idx_end>=t&&n.page_idx_end<=e)&&(n.draw(),n.page_idx_end+1>i.max_page&&(i.max_page=n.page_idx_end+1)),n=n.next}},clearPage:function(t){var e=this.getPageDom(t,"#svg-page");e&&e.querySelectorAll(".wordImg").forEach((function(t,e){t.remove()}));var i=this.getPageDom(t,"#rectParent");i&&(i.innerHTML="");var a=this.getPageDom(t,"#selection");a&&(a.innerHTML=""),this.clearTextBackground(t),e=this.getPageDom(t),e&&(e.innerHTML=""),e=this.getPageDom(t,"#table-border"),e&&(e.innerHTML=""),this.getPageDom.page_dom={}},clearTextBackground:function(t){var e=this.getPageDom(t,"#colorBlock");e&&(e.innerHTML="")},clearBackground:function(){document.querySelectorAll("#selection").forEach((function(t,e){t.innerHTML=""}))},repaint:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;console.log("repaint: page_idx:"+t+" num:"+e);for(var i=0;i<e;i++)this.clearPage(i+t);return this.drawPage(t,t+e),c["d"].g_cursor&&c["d"].g_cursor_end?this.drawBackgroundByCell(c["d"].g_cursor,c["d"].g_cursor_end):c["d"].g_cursor&&this.drawCursorByCell(c["d"].g_cursor),c["d"].g_word_page.max_page||1},drawBackgroundByCell:function(t,e){var i,a,n;this.clearCursor(),this.clearBackground();var r=z["a"].getBeginCell(t,e),l=r[0],s=r[1];if(l.compareCursor(s,l.latter,s.latter))return c["d"].g_cursor=l,c["d"].g_cursor_end=null,void this.drawCursorByCell(l);var o=l.paragraph,h=s.paragraph,d=null,g=null===(i=o.parent)||void 0===i?void 0:i.type,p=null===(a=o.parent)||void 0===a?void 0:a.type,u=o;if("lite_table"===g&&o.parent.id===(null===(n=h.parent)||void 0===n?void 0:n.id))o.drawBackground(l,s);else if("lite_table"===g&&"lite_table"===p){o.drawBackground(l),u=o.next;while(u){if(u.id===(null===h||void 0===h?void 0:h.id)){h.drawBackground(null,s);break}u.drawBackground(),u=u.next}}else if("lite_table"===g){l.latter&&(d=l.paragraph.parent_seq,l=d.getNextCell(l)),u.drawBackground(l);while(u){if(u.id===(null===h||void 0===h?void 0:h.id)){h.drawBackground(0,s.idx);break}u.drawBackground(),u=u.next}}else if("lite_table"===p){o.drawBackground(l),u=o.next,s.latter||(d=s.paragraph.parent_seq,s=d.getPrevCell(s));while(u){if(u.id===(null===h||void 0===h?void 0:h.id)){h.drawBackground(null,s);break}u.drawBackground(),u=u.next}}else if(o.id===h.id)o.drawBackground(l,s);else{o.drawBackground(l),u=o.next;while(u){if(u.id===(null===h||void 0===h?void 0:h.id)){u.drawBackground(null,s);break}u.drawBackground(),u=u.next}}},drawCursorByCell:function(t){if(!c["d"].g_cursor_end&&t){var e=null,i=null;"paragraph"===t.node.type?(e=new y(t.text_begin.x,t.text_begin.y),i=new y(t.text_begin.x,t.text_end.y)):t.latter?(e=new y(t.text_end.x,t.text_begin.y),i=new y(t.text_end.x,t.text_end.y)):(e=new y(t.text_begin.x,t.text_begin.y),i=new y(t.text_begin.x,t.text_end.y)),c["d"].g_cursor_height=i.y-e.y;var a=.12*c["d"].g_cursor_height;e.y+=a,i.y+=a,this.drawCursor(t.page_idx,e,i)}},clearCursor:function(t){t||(t=c["d"].g_cursor),c["d"].g_cursor_height=0,this.drawCursor(t.page_idx,new y(0,0),new y(0,0))},createPath:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return i?"M "+t+" "+e+" ":"L "+t+" "+e+" "}}),F=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;Object(h["a"])(this,t),this.id=null,e&&(this.id=e+"-"+i),this.type=e,this.format=i,this.level=null,this.left_indent=n,this.abstract_id=a,this.child=[]},M=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(h["a"])(this,t),e?(c["d"].g_id_count++,this.type=e,this.id=e+"-"+c["d"].g_id_count):(this.type=null,this.id=null),this.begin=i||new y(0,0),this.end=a||new y(0,0),this.cell_pos=[],this.row_begin_x=0,this.row_end_x=c["d"].g_word_page.page_width-c["d"].g_word_page.right_margin,this.position=null,this.page_idx=0,this.page_idx_end=0,this.prev=null,this.next=null,this.parent=null,this.table_cell=null,this.row_height=0,this.min_height=null,this.readonly=!1}return Object(d["a"])(t,[{key:"isRange",value:function(t,e,i){return this.begin.x<=e&&e<=this.end.x&&this.begin.y<=i&&i<=this.end.y}},{key:"getCursorCell",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(null===e)return this.cell_pos[0];for(var a=new y(e,i),n=0;n<this.cell_pos.length;n++){var r=this.cell_pos[n];if(t===r.page_idx&&r.check(a))return r}}},{key:"getFirstCell",value:function(){return this.cell_pos[0]}},{key:"getLastCell",value:function(){return this.cell_pos[this.cell_pos.length-1]}},{key:"copyStyle",value:function(t){t.font&&(this.font||(this.font={}),t.font.size&&(this.font.size=t.font.size),t.font.color&&(this.font.color=t.font.color),t.font.family&&(this.font.family=t.font.family),t.font.decoration&&(this.font.decoration=t.font.decoration),t.font.weight&&(this.font.weight=t.font.weight),t.font.style&&(this.font.style=t.font.style)),t.bg&&(this.bg||(this.bg={}),t.bg.color&&(this.bg.color=t.bg.color)),t.horizontal&&(this.horizontal=t.horizontal),t.space_left&&(this.space_left=t.space_left),t.space_right&&(this.space_right=t.space_right),this.page_idx=t.page_idx,this.page_idx_end=t.page_idx_end}}]),t}(),T=function(t){u(i,t);var e=b(i);function i(){var t,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"left",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,d=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,g=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,p=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;return Object(h["a"])(this,i),t=e.call(this),c["d"].g_paragraph_count++,t.type="paragraph",t.id=t.type+"-"+c["d"].g_paragraph_count,t.font=JSON.parse(JSON.stringify(a||{size:c["e"]["size"],family:c["e"]["family"]})),t.bg={},t.horizontal=n,t.horizontal_left_blank=0,t.space_left=0,t.space_right=0,t.left_indent=r,t.right_indent=l,t.first_line_indent=s,t.space_before=o,t.space_after=d,t.line_spacing_rule=g,t.line_spacing=p,t.runs=new B,t.parent_seq=null,t.row_idx=null,t.col_idx=null,t.text="",t.idx=0,t.page_idx=0,t.page_idx_end=0,t.dict_row_height={},t.margin=0,t.enter=null,t.paragraph_symbol=null,t.paragraph_abstract_id=null,t.paragraph_serial=null,t.paragraph_level=0,t.paragraph_blank=0,t.paragraph_text="",t.paragraph_x=[],t.paragraph_y=[],t.begin=new y(c["d"].g_word_page.left_margin,c["d"].g_word_page.top_margin),t.end=null,t.row_begin_x=c["d"].g_word_page.left_margin+t.left_indent+t.first_line_indent,t.row_end_x=c["d"].g_word_page.page_width-c["d"].g_word_page.right_margin,t}return Object(d["a"])(i,[{key:"calcPosition",value:function(t){this.begin=t.copy(),this.row_begin_x=this.begin.x,this.dict_row_height={},this.idx=0,this.cell_pos=[];var e=c["d"].g_word_page,i=z["a"].get_font_size("中",this.font.size,this.font.family),a=this.runs.getFirstNode(),n=z["a"].get_row_height(this.line_spacing_rule,this.line_spacing,this.font.size);this.dict_row_height={0:new S(n,i.height)},t.y+n>e.page_height-e.bottom_margin&&(this.page_idx++,this.page_idx_end=this.page_idx,this.begin.y=t.y=e.top_margin),this.paragraph_text="",this.paragraph_x=[],this.paragraph_y=[],this.paragraph_symbol=this.getParagraphSymbol(),this.paragraph_symbol&&(t=this.makeParagraph(this.page_idx,t,i),this.paragraph_blank=t.x-this.begin.x);var r=t,l=0;while(a)a.row_begin_x=0===l?this.row_begin_x+this.first_line_indent+this.left_indent:this.row_begin_x+this.left_indent,a.row_end_x=this.row_end_x-this.right_indent,a.parent=this,r=a.calcRowHeight(r,this.dict_row_height),a=a.next,l++;"center"===this.horizontal?r.x<this.row_end_x&&(this.horizontal_left_blank=(this.row_end_x-r.x)/2):"right"===this.horizontal?r.x<this.row_end_x&&(this.horizontal_left_blank=this.row_end_x-r.x):this.horizontal_left_blank=0,this.text="",r=t;var s=this.runs.getFirstNode();a=s;var o=Math.max.apply(Math,Object(g["a"])(Object.keys(this.dict_row_height)));0===o&&(r.x+=this.horizontal_left_blank);while(a){var h;if(a.bg&&(this.bg=a.bg),"text"===a.type&&""===a.text)a.row=[],a.cell_pos=[];else a.page_idx=this.page_idx_end,a.page_idx_end=this.page_idx_end,this.text+=(null===(h=a)||void 0===h?void 0:h.text)||"",r=a.calcPosition(r,o),this.page_idx_end=a.page_idx_end,s.id===a.id&&(this.page_idx!==a.page_idx?(this.page_idx=a.page_idx,this.begin=a.begin.copy()):(a.begin.x=this.begin.x,a.row[0].begin.x=this.begin.x,this.cell_pos[0].begin.x=this.begin.x));a=a.next}var d=Object.keys(this.dict_row_height);n=this.dict_row_height[0].row_height;var p=this.dict_row_height[0].char_height,u=null;if(0===this.paragraph_text.indexOf("&#")){var _=z["a"].get_font_height(this.paragraph_text,this.font.size,this.font.family);u=z["a"].get_text_blank(n,_,p)}else u=z["a"].get_text_blank(n,i.height,p);for(var v=0;v<this.paragraph_y.length;v++)this.paragraph_y[v]=this.paragraph_y[v]+n-u[1];return n=this.dict_row_height[d.length-1].row_height,p=this.dict_row_height[d.length-1].char_height,u=z["a"].get_text_blank(n,i.height,p),this.enter=new k(this.page_idx_end,r,new y(this.row_end_x,r.y+n),this,this,new y(r.x,r.y+u[0]),new y(r.x+i.width,r.y+n-u[1]),this.idx),this.runs.getFirstNode()||(this.enter.begin.x=this.row_begin_x),this.enter.latter=!1,this.end=new y(this.row_end_x,this.enter.end.y),this.cell_pos.push(this.enter),c["a"]&&this.draw(),new y(this.begin.x,this.end.y)}},{key:"draw",value:function(){var t,e=new P(this.page_idx);this.paragraph_text&&(e.font["color"]=null,e.font["weight"]=null,e.font["style"]=null,e.font["decoration"]=null,e.font["size"]=this.font.size,e.position={x:this.paragraph_x,y:this.paragraph_y},e.text=this.paragraph_text,L.drawText(e));var i=this.runs.getFirstNode();while(i)i.draw(),i=i.next;var a=this.enter;if(e.text="&#8629",e.page_idx=this.page_idx_end,e.position={x:[a.text_begin.x],y:[a.text_end.y-2]},"lite_table"===(null===(t=this.parent)||void 0===t?void 0:t.type)?(e.font={size:c["e"]["size"]},e.font.size=parseInt(.5*e.font.size)):(e.font=JSON.parse(JSON.stringify(this.font)),e.font.size=parseInt(.5*e.font.size)),L.drawText(e),c["b"]){var n,l=Object(r["a"])(this.cell_pos);try{for(l.s();!(n=l.n()).done;)a=n.value,L.drawRect(a.page_idx,a.begin,a.end,"#FF0000")}catch(o){l.e(o)}finally{l.f()}}if(c["c"])if(this.page_idx===this.page_idx_end)L.drawRect(this.page_idx,this.begin,this.end,"#00FF00");else for(var s=this.page_idx;s<=this.page_idx_end;s++)s===this.page_idx?L.drawRect(s,this.begin,new y(this.row_end_x,c["d"].g_word_page.page_height-c["d"].g_word_page.bottom_margin),"#00FF00"):s===this.page_idx_end?L.drawRect(s,new y(this.row_begin_x,c["d"].g_word_page.top_margin),this.end,"#00FF00"):L.drawRect(s,new y(this.row_begin_x,c["d"].g_word_page.top_margin),new y(this.row_end_x,c["d"].g_word_page.page_height-c["d"].g_word_page.bottom_margin),"#00FF00")}},{key:"drawBackground",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=!1,a=!0;if(t?i=t.latter:t=this.cell_pos[0],e?a=e.latter:e=this.cell_pos[this.cell_pos.length-1],!t.compareCursor(e,i,a)){var n=t.bg_begin,r=e.bg_end;i&&(n=new y(t.bg_end.x,t.bg_begin.y)),a||(r=new y(e.bg_begin.x,e.bg_end.y)),t.page_idx===e.page_idx&&Math.round(t.bg_begin.y)===Math.round(e.bg_begin.y)?L.drawBackground(t.page_idx,[{start:n,end:r}]):(L.drawBackground(t.page_idx,[{start:n,end:new y(this.row_end_x,t.bg_end.y)}]),t.bg_end.y!==e.bg_begin.y&&L.drawBackground(e.page_idx,[{start:new y(this.row_begin_x+this.paragraph_blank,t.bg_end.y),end:new y(this.row_end_x,e.bg_begin.y)}]),L.drawBackground(e.page_idx,[{start:new y(this.row_begin_x+this.paragraph_blank,e.bg_begin.y),end:r}]))}}},{key:"isRange",value:function(t,e,i){var a=c["d"].g_word_page;if(t<this.page_idx);else if(this.page_idx===t&&this.page_idx_end===t){if(this.begin.x<=e&&e<=this.end.x&&this.begin.y<=i&&i<=this.end.y)return!0}else if(this.page_idx_end===t){if(this.row_begin_x<=e&&e<=this.row_end_x&&a.top_margin<=i&&i<=this.end.y)return!0}else if(t<this.page_idx_end&&this.row_begin_x<=e&&e<=this.row_end_x&&a.top_margin<=i&&i<=a.page_height-a.bottom_margin)return!0;return!1}},{key:"getCursorCell",value:function(t,e,i){var a=this.runs.getFirstNode(),n=null,l=!1;while(a){var s,o=Object(r["a"])(a.row);try{for(o.s();!(s=o.n()).done;){var h=s.value;if(h.isRange(t,e,i)){var d,c=Object(r["a"])(h.lst_idx);try{for(c.s();!(d=c.n()).done;){var g=d.value;if(n=this.cell_pos[g],l=n.isRange(t,e,i),l)return n}}catch(p){c.e(p)}finally{c.f()}return this.cell_pos[this.cell_pos.length-1]}}}catch(p){o.e(p)}finally{o.f()}a=a.next}return n=this.cell_pos[this.cell_pos.length-1],n}},{key:"getFirstRowHeight",value:function(){return this.dict_row_height[0].row_height}},{key:"getFirstNode",value:function(){return this.runs.getFirstNode()}},{key:"getLastNode",value:function(){return this.runs.getLastNode()}},{key:"getFirstCell",value:function(){return this.cell_pos[0]}},{key:"getLastCell",value:function(){return this.cell_pos[this.cell_pos.length-1]}},{key:"deleteLastCell",value:function(){var t=this.runs.getLastNode();"text"===t.type?""===t.text?(this.runs.delete(t),this.deleteLastCell()):t.text=t.text.slice(0,t.text.length-1):"image"===t.type&&this.runs.delete(t)}},{key:"deleteCell",value:function(t){var e=t.idx,i=t.node;if("image"===i.type)this.runs.delete(i),this.cell_pos.splice(e,1);else if("text"===i.type){var a=i.text;i.text=a.slice(0,t.run_idx),i.text+=a.slice(t.run_idx+1),""===i.text&&this.runs.delete(i),this.cell_pos.splice(e,1)}}},{key:"copyTextStyle",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=null===e||void 0===e?void 0:e.node,n=null===i||void 0===i?void 0:i.node,r=null,l=null,s=null;if(e&&i){if(r=a,"text"===a.type){if(l=a.text,a.text=l.slice(0,e.run_idx),a.id===n.id)return s=new D(l.slice(e.run_idx,i.run_idx+1),a.font,a.bg),s.text&&(s.copyStyle(t),this.runs.insert(a,s),r=s),s=new D(l.slice(i.run_idx+1),a.font,a.bg),void(s.text&&this.runs.insert(r,s));s=new D(l.slice(e.run_idx),a.font,a.bg),s.text&&(s.copyStyle(t),this.runs.insert(a,s),r=s)}r=r.next;while(r){if(r.id===n.id){"text"===n.type&&(l=n.text,n.text=l.slice(0,i.run_idx+1),s=new D(l.slice(i.run_idx+1),n.font,n.bg),n.copyStyle(t),this.runs.insert(n,s));break}r.copyStyle(t),r=r.next}}else if(e){"text"===a.type&&(l=a.text,a.text=l.slice(0,e.run_idx),s=new D(l.slice(e.run_idx),a.font,a.bg),s.text&&(s.copyStyle(t),this.runs.insert(a,s),r=s)),r=a.next;while(r)r.copyStyle(t),r=r.next}else if(i){r=a;while(r){if(r.id===n.id){"text"===n.type&&(l=n.text,n.text=l.slice(0,i.run_idx+1),s=new D(l.slice(i.run_idx+1),n.font,n.bg),n.copyStyle(t),this.runs.insert(n,s));break}r.copyStyle(t),r=r.next}}else{r=this.runs.getFirstNode();while(r)"text"===r.type&&r.copyStyle(t),r=r.next}}},{key:"copyStyle",value:function(t){var e;t?(t.font&&(this.font||(this.font={}),t.font.size&&(this.font.size=t.font.size),t.font.color&&(this.font.color=t.font.color),t.font.family&&(this.font.family=t.font.family),t.font.decoration&&(this.font.decoration=t.font.decoration),t.font.weight&&(this.font.weight=t.font.weight),t.font.style&&(this.font.style=t.font.style)),t.bg&&(this.bg||(this.bg={}),t.bg.color&&(this.bg.color=t.bg.color)),t.horizontal&&(this.horizontal=t.horizontal),this.line_spacing_rule=t.line_spacing_rule,this.line_spacing=t.line_spacing,this.left_indent=t.left_indent||0,this.right_indent=t.right_indent||0,this.paragraph_symbol=t.paragraph_symbol,this.paragraph_abstract_id=t.paragraph_abstract_id||(null===(e=t.paragraph_symbol)||void 0===e?void 0:e.abstract_id),this.paragraph_level=t.paragraph_level):(this.font={},this.bg={},this.horizontal="left",this.line_spacing_rule=0,this.line_spacing=0,this.left_indent=0,this.right_indent=0,this.paragraph_symbol=null,this.paragraph_abstract_id=null,this.paragraph_level=null)}},{key:"makeParagraph",value:function(t,e,i){var a=this.makeParagraphNumber(),n=.2*i.width,r=e.y;if(this.paragraph_symbol.left_indent)e.x+=this.paragraph_symbol.left_indent;else if(this.paragraph_level){var l=28.33*this.paragraph_level;e.x+=l}if(0===a.indexOf("&#"))this.paragraph_x.push(e.x),this.paragraph_y.push(r),e.x+=i.width;else for(var s=0;s<a.length;s++)a[s],this.paragraph_x.push(e.x),this.paragraph_y.push(r),e.x+=i.width;return e.x+=n,this.paragraph_text=a,e}},{key:"makeParagraphNumber",value:function(){if(this.paragraph_serial=1,"bullet"!==this.paragraph_symbol.type){var t=this.prev;while(t){if(t.paragraph_symbol&&t.paragraph_level===this.paragraph_level){this.paragraph_symbol.abstract_id===t.paragraph_symbol.abstract_id&&(this.paragraph_serial=t.paragraph_serial+1);break}t=t.prev}}return z["a"].get_paragraph_symbol(this.paragraph_symbol,this.paragraph_serial)}},{key:"getParagraphSymbol",value:function(){var t,e;if(this.paragraph_symbol);else if(this.paragraph_abstract_id){var i=c["d"].g_word_page;i.paragraph_bullet.hasOwnProperty(this.paragraph_abstract_id)?this.paragraph_symbol=i.paragraph_bullet[this.paragraph_abstract_id]:i.paragraph_number.hasOwnProperty(this.paragraph_abstract_id)?this.paragraph_symbol=i.paragraph_number[this.paragraph_abstract_id]:Object.keys(i.paragraph_bullet).length>0?this.paragraph_symbol=i.paragraph_bullet[Object.keys(i.paragraph_bullet)[0]]:Object.keys(i.paragraph_number).length>0&&(this.paragraph_symbol=i.paragraph_number[Object.keys(i.paragraph_number)[0]])}return this.paragraph_level>0&&this.paragraph_symbol&&(null===(t=this.paragraph_symbol)||void 0===t||null===(e=t.child)||void 0===e?void 0:e.length)>=this.paragraph_level&&(this.paragraph_symbol=this.paragraph_symbol.child[this.paragraph_level-1]),this.paragraph_symbol}}]),i}(M),P=function(t){u(i,t);var e=b(i);function i(){var t,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Object(h["a"])(this,i),t=e.call(this,"text_row"),t.text="",t.lst_idx=[],t.begin=null,t.end=null,t.text_begin=null,t.text_end=null,t.row_width=0,t.page_idx=a,t.position={x:[],y:[]},t.font={},t}return i}(M),D=function(t){u(i,t);var e=b(i);function i(){var t,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return Object(h["a"])(this,i),t=e.call(this,"text"),t.text=a,t.font=JSON.parse(JSON.stringify(n)),t.bg=JSON.parse(JSON.stringify(r)),t.href=l,t.line_spacing=1,t.margin=0,t.row=[],t.row_idx=0,t.char_width=0,t.char_width_chinese=0,t.char_height=0,t.row_height=0,t.row_begin_x=c["d"].g_word_page.left_margin,t.row_end_x=c["d"].g_word_page.page_width-c["d"].g_word_page.right_margin,t.begin=null,t.end=null,t.text_begin=null,t.text_end=null,t.cell_pos=[],t.compare_equal=null,t}return Object(d["a"])(i,[{key:"isRange",value:function(t,e,i){for(var a=new y(e,i),n=0;n<this.cell_pos.length;n++){var r=this.cell_pos[n];if(r.check(a))return!0}return!1}},{key:"getCursorCell",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=null,n=null,l=0;l<this.row.length;l++)if(n=this.row[l],n.isRange(t,e,i)&&n.lst_idx.length>0){var s,o=Object(r["a"])(n.lst_idx);try{for(o.s();!(s=o.n()).done;){var h=s.value;if(a=this.cell_pos[h],a.isRange(t,e,i))return a}}catch(d){o.e(d)}finally{o.f()}if(a=this.cell_pos[n.lst_idx[0]],e<=a.begin.x)return a;if(a=this.cell_pos[n.lst_idx[n.lst_idx.length-1]],e>=a.end.x)return a}return a}},{key:"getFirstRowHeight",value:function(){var t=0;if(this.row.length>0){var e=this.row[0];t=e.end.y-e.begin.y}return t}},{key:"getFirstCell",value:function(){if(this.row.length>0){var t=this.row[0],e=t.lst_idx[0],i=this.parent;return i.cell_pos[e]}}},{key:"getLastCell",value:function(){if(this.row.length>0){var t=this.row[this.row.length-1],e=t.lst_idx[t.lst_idx.length-1],i=this.parent;return i.cell_pos[e]}}},{key:"equal",value:function(t){var e,i,a,n,r,l,s,h,d,c,g,p,u,_;return o["a"].isNull(this.compare_equal)?(null===(e=this.font)||void 0===e?void 0:e.size)===(null===(i=t.font)||void 0===i?void 0:i.size)&&(null===(a=this.font)||void 0===a?void 0:a.color)===(null===(n=t.font)||void 0===n?void 0:n.color)&&(null===(r=this.font)||void 0===r?void 0:r.family)===(null===(l=t.font)||void 0===l?void 0:l.family)&&(null===(s=this.font)||void 0===s?void 0:s.decoration)===(null===(h=t.font)||void 0===h?void 0:h.decoration)&&(null===(d=this.font)||void 0===d?void 0:d.weight)===(null===(c=t.font)||void 0===c?void 0:c.weight)&&(null===(g=this.font)||void 0===g?void 0:g.style)===(null===(p=t.font)||void 0===p?void 0:p.style)&&(null===(u=this.bg)||void 0===u?void 0:u.color)===(null===(_=t.bg)||void 0===_?void 0:_.color):this.compare_equal}},{key:"merge",value:function(t){null!==this.cursor_idx?(this.text=this.text.slice(0,this.cursor_idx)+t+this.text.slice(this.cursor_idx),this.cursor_idx+=t.length):(this.text+=t,this.cursor_idx=this.text.length)}},{key:"delete",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e||this.text&&(t>=this.text.length?this.text=this.text.slice(0,this.text.length-1):this.text=this.text.slice(0,t)+this.text.slice(t+1))}},{key:"copyStyle",value:function(t){t.font&&(this.font||(this.font={}),void 0!==t.font.size&&(this.font.size=t.font.size),void 0!==t.font.color&&(this.font.color=t.font.color),void 0!==t.font.family&&(this.font.family=t.font.family),void 0!==t.font.decoration&&(this.font.decoration=t.font.decoration),void 0!==t.font.weight&&(this.font.weight=t.font.weight),void 0!==t.font.style&&(this.font.style=t.font.style)),t.bg&&(this.bg||(this.bg={}),void 0!==t.bg.color&&(this.bg.color=t.bg.color)),void 0!==t.horizontal&&(this.horizontal=t.horizontal),void 0!==t.space_left&&(this.space_left=t.space_left),t.space_right&&(this.space_right=t.space_right)}},{key:"calcRowHeight",value:function(t,e){var i,a,n,r=t.x;r=r>this.row_begin_x?r:this.row_begin_x;var l=this.parent,s=this.text.length,o=Object.keys(e),h=0,d=null,g=z["a"].get_row_height(l.line_spacing_rule,l.line_spacing,(null===(i=this.font)||void 0===i?void 0:i.size)||c["e"]["size"]);this.char_height=z["a"].get_font_height("A",this.font.size,this.font.family),this.char_height>g&&(g=this.char_height),this.char_width_chinese=z["a"].get_draw_width("中",(null===(a=this.font)||void 0===a?void 0:a.size)||c["f"]["size"],(null===(n=this.font)||void 0===n?void 0:n.family)||c["f"]["family"]);var p,u=c["d"].default_reg_chinese;o.length>0?h=parseInt(o[o.length-1]):(d=z["a"].get_font_size("A",(null===(p=this.font)||void 0===p?void 0:p.size)||c["e"]["size"]),e[h]=new S(g,d.height));this.row_idx=h;for(var _=null,v=0,f=0;f<s;f++){var w;if(_=this.text.charAt(f),u.test(_))v=this.char_width_chinese;else v=z["a"].get_draw_width(_,(null===(w=this.font)||void 0===w?void 0:w.size)||c["e"]["size"]);r+v>this.row_end_x-l.right_indent?(r=this.row_begin_x+v,h+=1,e[h]=new S(g,this.char_height,r)):(r+=v,g>e[h].row_height&&(e[h]=new S(g,this.char_height,r)))}return new y(r,0)}},{key:"calcPosition",value:function(t,e){var i=this.parent.dict_row_height,a=this.row_idx,n=i[a],r=n.row_height,l=this.page_idx,s=this.parent,o=!1;this.begin=t,this.end=null,this.row=[],this.cell_pos=[];var h=t.x,d=t.y,g=this.text.length,p=0,u=c["d"].g_word_page,_=null,v=null,f=new P(l);f.font=this.font,f.begin=new y(h,d);for(var w=z["a"].get_text_blank(r,this.char_height,n.char_height),m=0;m<g;m++){0===m&&(f.is_begin=!0,d+r>u.page_height-u.bottom_margin&&(d=u.top_margin,l++,f.page_idx=l,f.begin=new y(h,d),this.page_idx=l,this.page_idx_end=l,this.begin=new y(h,d))),v=this.text.charAt(m);var x,b,C=0;if(c["d"].default_reg_chinese.test(v))C=this.char_width_chinese;else C=z["a"].get_draw_width(v,(null===(x=this.font)||void 0===x?void 0:x.size)||c["e"]["size"],(null===(b=this.font)||void 0===b?void 0:b.family)||c["e"]["family"]);p=C,h+p>this.row_end_x-s.right_indent?(f.end=new y(this.row_end_x-s.right_indent,d+r),this.row.push(f),0!==m&&_&&(_.end.x=f.end.x),h=this.row_begin_x,d+=r,d+r>u.page_height-u.bottom_margin&&(d=u.top_margin,l++,this.page_idx_end=l),f=new P(l),f.font=this.font,f.begin=new y(h,d),f.text=v,a++,n=i[a],r=n.row_height,w=z["a"].get_text_blank(r,this.char_height,n.char_height),a===e&&(o=!0)):f.text+=v,f.position["y"].push(d+r-w[1]),_=new k(l),_.idx=s.idx,_.run_idx=m,_.paragraph=s,_.node=this,o?(f.position["x"].push(h+s.horizontal_left_blank),_.begin=new y(h,d),_.end=new y(h+s.horizontal_left_blank+p,d+r),_.text_begin=new y(h+s.horizontal_left_blank,d+w[0]),_.text_end=new y(h+s.horizontal_left_blank+p,d+r-w[1]),_.bg_begin=new y(h+s.horizontal_left_blank,d),_.bg_end=new y(h+s.horizontal_left_blank+p,d+r),h+=s.horizontal_left_blank,o=!1):(f.position["x"].push(h),_.begin=new y(h,d),_.end=new y(h+p,d+r),_.text_begin=new y(h,d+w[0]),_.text_end=new y(h+p,d+r-w[1]),_.bg_begin=new y(h,d),_.bg_end=new y(h+p,d+r)),f.lst_idx.push(s.idx),s.idx++,s.cell_pos.push(_),m+1===g&&(f.is_end=!0,f.end=new y(h+p,d+r),this.end=f.end,this.row.push(f)),h+=p}return this.end||(this.end=new y(h,d+r)),c["a"]&&this.draw(),new y(this.end.x,this.end.y-r)}},{key:"draw",value:function(){var t;if(L.drawMultiLineText(this),null!==(t=this.bg)&&void 0!==t&&t.color){var e,i=Object(r["a"])(this.row);try{for(i.s();!(e=i.n()).done;){var a=e.value;a.begin&&a.end&&L.drawTextBackground(a.page_idx,[{start:a.begin,end:a.end}],this.bg.color)}}catch(o){i.e(o)}finally{i.f()}}if(c["b"]){var n,l=Object(r["a"])(this.cell_pos);try{for(l.s();!(n=l.n()).done;){var s=n.value;L.drawRect(s.page_idx,s.begin,s.end,"#FF0000")}}catch(o){l.e(o)}finally{l.f()}}}}]),i}(M),N=function t(e,i){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;Object(h["a"])(this,t),this.type="table_line",this.page_idx=i,this.begin=a,this.end=n,this.row_idx=r,this.col_idx=l,this.id=e,this.top=0,this.bottom=0,this.left=0,this.right=0},H=function(t){u(i,t);var e=b(i);function i(t){var a,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(h["a"])(this,i),a=e.call(this,"lite_table");var l=c["d"].g_word_page;if(a.width=l.content_width,a.data=t||[],a.merged_cells=n||[],a.col_width=r||{},a.cell_horizontal={},a.cell_vertical={},a.row_height={},a.page_max_y={},a.min_row_height={},a.min_col_width=10,a.space_left=6,a.space_right=6,a.divide_top=!1,a.divide_bottom=!1,a.position=[],a.cell_pos=[],a.dict_x={},a.dict_y={},a.merge_row_y={},a.row_num=a.data.length,a.col_num=0,a.data&&!a.col_width){a.col_num=a.data[0].length;for(var s=a.width/a.col_num,o=0;o<col_num;o++)a.col_width[o]=s}return a.left_indent=0,a.row_begin_x=l.left_margin,a.row_end_x=l.page_width-l.right_margin,a}return Object(d["a"])(i,[{key:"calcPosition",value:function(t){if(this.data&&0!==this.data.length){t.x=this.row_begin_x+this.left_indent,this.position=[],this.cell_pos=[],this.row_height={};var e=null,i=null,a=null,n=null,r=0;this.begin=t;var l={},s={},h={},d=this.data[0].length;for(this.row_num=this.data.length,this.col_num=d,r=0;r<d+1;r++){var p=0;for(i=0;i<r;i++)p+=this.col_width[i];l[r]=o["a"].toFixed(t.x+p,2)}var u=0,_=[],v=this.data.length;this.merge_row_y={};var f=this.page_idx,w=c["d"].g_word_page,m={};n=0,s[0]=o["a"].toFixed(this.begin.y,2),h[0]=this.page_idx_end;while(n<v)m={},u=this.calcRowPosition(n,l,s,m),s[n]+u>w.page_height-w.bottom_margin&&(this.page_idx_end++,s[n]=w.top_margin,h[n]=this.page_idx_end,m={},this.calcRowPosition(n,l,s,m)),u=0,_=Object.keys(m),this.page_idx_end=Math.max.apply(Math,Object(g["a"])(_)),s[n+1]=m[this.page_idx_end],h[n+1]=this.page_idx_end,n++;for(this.dict_x=l,this.dict_y=s,this.end=new y(l[d],s[v]),n=0;n<v;n++)if(h[n+1]!==h[n])for(f=h[n];f<h[n+1]+1;f++)f===h[n]?this.addCell(f,n,v,d,s[n],w.page_height-w.bottom_margin):f===h[n+1]?this.addCell(f,n,v,d,w.top_margin,s[n+1]):this.addCell(f,n,v,d,w.top_margin,w.page_height-w.bottom_margin);else this.addCell(h[n],n,v,d,s[n],s[n+1]);var x=null,b=null,k=[],C=null;n=0;while(n<v+1){if(f=h[n],a=this.id+"-row-"+n,k=[],n>0&&n<this.row_num&&this.calcRowLine(n,k).length>0){i=0;while(i<k.length)C=k[i],x=C,b=k[i+1],e=new N(a,f,new y(l[x],s[n]),new y(l[b],s[n]),n),this.position.push(e),i+=2}else if(n<v&&h[n+1]!==h[n])for(f=h[n];f<h[n+1]+1;f++)f===h[n]?(e=new N(a,f,new y(l[0],s[n]),new y(l[d],s[n]),n),this.position.push(e),e=new N(null,f,new y(l[0],w.page_height-w.bottom_margin),new y(l[d],w.page_height-w.bottom_margin),n),this.position.push(e)):f===h[n+1]?(e=new N(null,f,new y(l[0],w.top_margin),new y(l[d],w.top_margin),n),this.position.push(e),n++,a=this.id+"-row-"+n,e=new N(a,f,new y(l[0],s[n]),new y(l[d],s[n]),n),this.position.push(e)):(e=new N(null,f,new y(l[0],w.top_margin),new y(l[d],w.top_margin),n),this.position.push(e),e=new N(null,f,new y(l[0],w.page_height-w.bottom_margin),new y(l[d],w.page_height-w.bottom_margin),n),this.position.push(e));else f=h[n],e=new N(a,f,new y(l[0],s[n]),new y(l[d],s[n]),n),this.position.push(e);n++}var S=null,z=null;for(r=0;r<d+1;r++)if(f=this.page_idx,a=this.id+"-col-"+r,k=[],r>0&&r<this.col_num&&this.calcColLine(r,k).length>0){i=0;while(i<k.length){if(C=k[i],x=C,b=k[i+1],S=h[x],z=h[b],x===b);else if(S!==z)for(f=S;f<z+1;f++)e=f===S?new N(a,f,new y(l[r],s[x]),new y(l[r],w.page_height-w.bottom_margin),null,r):new N(a,f,new y(l[r],w.top_margin),new y(l[r],f===z?s[b]:w.page_height-w.bottom_margin),null,r),this.position.push(e);else f=S,e=new N(a,f,new y(l[r],s[x]),new y(l[r],s[b]),null,r),this.position.push(e);i+=2}}else if(this.page_idx!==this.page_idx_end)for(f=this.page_idx;f<this.page_idx_end+1;f++)e=f===this.page_idx?new N(a,f,new y(l[r],s[0]),new y(l[r],w.page_height-w.bottom_margin),null,r):f===this.page_idx_end?new N(a,f,new y(l[r],w.top_margin),new y(l[r],s[v]),null,r):new N(a,f,new y(l[r],w.top_margin),new y(l[r],w.page_height-w.bottom_margin),null,r),this.position.push(e);else e=new N(a,f,new y(l[r],s[0]),new y(l[r],s[v]),null,r),this.position.push(e);return c["a"]&&this.draw(),new y(w.left_margin,s[v])}}},{key:"calcRowPosition",value:function(t,e,i,a){for(var n=null,r=null,l=null,s=this.data[t],o=this.page_idx_end,h=0,d=0;d<this.col_num;d++)if(n=s[d],n)if(this.isMergeCells(t,d))s[d]=null,r=null;else{l=new y(e[d],i[t]),r=n.getFirstNode(),r.parent=this,r.row_idx=t,r.col_idx=d,r.page_idx=o,r.page_idx_end=o;while(r){r.parent=this,r.row_idx=t,r.col_idx=d,r.row_begin_x=e[d]+this.space_left,r.row_end_x=this.get_row_end_x(t,d,e)-this.space_right,l.x<r.row_begin_x&&(l.x=r.row_begin_x),l=r.calcPosition(l);var c=r.getFirstRowHeight();c>h&&(h=c),a.hasOwnProperty(r.page_idx_end)||(a[r.page_idx_end]=l.y),l.y>a[r.page_idx_end]&&(a[r.page_idx_end]=l.y),r.next&&(r.next.page_idx=r.page_idx_end,r.next.page_idx_end=r.page_idx_end),r=r.next}}return h}},{key:"draw",value:function(){var t,e=null,i=Object(r["a"])(this.data);try{for(i.s();!(t=i.n()).done;){var a,n=t.value,l=Object(r["a"])(n);try{for(l.s();!(a=l.n()).done;){var s=a.value;if(s){e=s.getFirstNode();while(e)e.draw(),e=e.next}}}catch(g){l.e(g)}finally{l.f()}}}catch(g){i.e(g)}finally{i.f()}if(L.drawTable(this),c["a"]&&c["c"]){var o,h=Object(r["a"])(this.cell_pos);try{for(h.s();!(o=h.n()).done;){var d=o.value;L.drawRect(d.page_idx,d.begin,d.end,"#FF0000")}}catch(g){h.e(g)}finally{h.f()}}}},{key:"isMergeCells",value:function(t,e){var i,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=Object(r["a"])(this.merged_cells);try{for(n.s();!(i=n.n()).done;){var l=i.value,s=l.split(":"),o=s[0].split("-"),h=s[1].split("-"),d=Number(o[0]),c=Number(o[1]),g=Number(h[0]),p=Number(h[1]);if(d===t&&c===e)return!!a;if(d<=t&&g>=t&&c<=e&&p>=e)return!0}}catch(u){n.e(u)}finally{n.f()}return!1}},{key:"getMergeFirst",value:function(t,e){var i,a=Object(r["a"])(this.merged_cells);try{for(a.s();!(i=a.n()).done;){var n=i.value,l=n.split(":"),s=l[0].split("-"),o=l[1].split("-"),h=Number(s[0]),d=Number(s[1]),c=Number(o[0]),g=Number(o[1]);if(h<=t&&c>=t&&d<=e&&g>=e)return[h,d]}}catch(p){a.e(p)}finally{a.f()}return[t,e]}},{key:"getMergeNextRow",value:function(t,e){var i,a=Object(r["a"])(this.merged_cells);try{for(a.s();!(i=a.n()).done;){var n=i.value,l=n.split(":"),s=l[0].split("-"),o=l[1].split("-"),h=Number(s[0]),d=Number(s[1]),c=Number(o[0]),g=Number(o[1]);if(h<=t&&c>=t&&d<=e&&g>=e)return c+1<this.row_num?c+1:c}}catch(p){a.e(p)}finally{a.f()}return t+1<this.row_num?t+1:t}},{key:"getMergerPrevRow",value:function(t,e){var i,a=Object(r["a"])(this.merged_cells);try{for(a.s();!(i=a.n()).done;){var n=i.value,l=n.split(":"),s=l[0].split("-"),o=l[1].split("-"),h=Number(s[0]),d=Number(s[1]),c=Number(o[0]),g=Number(o[1]);if(h<=t&&c>=t&&d<=e&&g>=e)return h>0?h-1:h}}catch(p){a.e(p)}finally{a.f()}return t>0?t-1:t}},{key:"calcRowLine",value:function(t,e){var i,a=0,n=0,l=Array.from({length:this.col_num},(function(t,e){return e})),s=Object(r["a"])(this.merged_cells);try{for(s.s();!(i=s.n()).done;){var o=i.value,h=o.split(":"),d=h[0].split("-"),c=h[1].split("-"),g=Number(d[0]),p=Number(d[1]),u=Number(c[0]),_=Number(c[1]);if(g<t&&u>=t)for(a=p;a<_+1;a++)n=l.indexOf(a),n>-1&&l.splice(n,1)}}catch(w){s.e(w)}finally{s.f()}if(l.length>0){a=0;var v=0,f=0;for(a=0;a<l.length;a++)f=l[a],0===a?(e.push(f),1===l.length&&e.push(f+1)):f-1>v?(e.push(v+1),a+1===l.length&&(e.push(f),e.push(f+1))):a+1===l.length&&e.push(f+1),v=f}return e}},{key:"calcColLine",value:function(t,e){var i,a=0,n=0,l=0,s=Array.from({length:this.row_num},(function(t,e){return e})),o=Object(r["a"])(this.merged_cells);try{for(o.s();!(i=o.n()).done;){var h=i.value,d=h.split(":"),c=d[0].split("-"),g=d[1].split("-"),p=Number(c[0]),u=Number(c[1]),_=Number(g[0]),v=Number(g[1]);if(u<t&&v>=t)for(l=p;l<_+1;l++)n=s.indexOf(l),n>-1&&s.splice(n,1)}}catch(w){o.e(w)}finally{o.f()}if(s.length>0){a=0;var f=0;for(a=0;a<s.length;a++)l=s[a],0===a?(e.push(l),1===s.length&&e.push(l+1)):l-1>f?(e.push(f+1),a+1===s.length&&(e.push(l),e.push(l+1))):a+1===s.length&&e.push(l+1),f=l}return e}},{key:"isRange",value:function(t,e,i){var a=c["d"].g_word_page;if(t<this.page_idx);else if(this.page_idx===t&&this.page_idx_end===t){if(this.begin.x<=e&&e<=this.end.x&&this.begin.y<=i&&i<=this.end.y)return!0}else if(this.page_idx_end===t){if(this.row_begin_x<=e&&e<=this.row_end_x&&a.top_margin<=i&&i<=this.end.y)return!0}else if(t<this.page_idx_end&&this.row_begin_x<=e&&e<=this.row_end_x&&a.top_margin<=i&&i<=a.page_height-a.bottom_margin)return!0;return!1}},{key:"addCell",value:function(t,e,i,a,n,r){for(var l=null,s=null,h=(c["d"].g_word_page,0);h<a;h++){s=new C(e,h),s.begin=new y(this.dict_x[h],n),s.end=new y(o["a"].toFixed(this.dict_x[h]+this.col_width[h],2),r),s.page_idx=t,this.cell_pos.push(s),l=this.data[e][h];while(l)l.table_cell=s,l.parent=this,l=l.next}}},{key:"copyStyle",value:function(t){}},{key:"getCursorCell",value:function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=null,r=null,l=null,s=null,o=null,h=null;if(a){if(n=this.data[a.row_idx][a.col_idx],n||(h=this.getMergeFirst(a.row_idx,a.col_idx),s=h[0],o=h[1],n=this.data[s][o]),n)return l=n.getCellByPos(t,e,i),l||(r=n.getLastNode(),l=r.getCursorCell(t,e,i)),l}else for(var d=0;d<this.cell_pos.length;d++)if(l=this.cell_pos[d],l.isRange(t,e,i)&&(n=this.data[l.row_idx][l.col_idx],n||(h=this.getMergeFirst(l.row_idx,l.col_idx),s=h[0],o=h[1],n=this.data[s][o]),n)){r=n.getFirstNode(),e<l.begin.x+this.space_left?e=l.begin.x+this.space_left+2:e>l.end.x&&(e=l.end.x-2);while(r){if(r.page_idx>t)break;if(r.isRange(t,e,i))return r.getCursorCell(t,e,i);r=r.next}return r=n.getLastNode(),r.getCursorCell(t,e,i)}}},{key:"getCellByPos",value:function(t,e,i){for(var a=null,n=0;n<this.cell_pos.length;n++)if(a=this.cell_pos[n],a.isRange(t,e,i))return a}},{key:"getFirstCell",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=null;if(t>-1&&t<this.row_num&&e>-1&&e<this.col_num){if(i=this.data[t][e],!i){var a=this.getMergeFirst(t,e);i=this.data[a[0]][a[1]]}if(i)return i.getFirstNode().getFirstCell()}}},{key:"getLastCell",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.row_num-1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.col_num-1,i=null;if(t>-1&&t<this.row_num&&e>-1&&e<this.col_num){if(i=this.data[t][e],!i){var a=this.getMergeFirst(t,e);i=this.data[a[0]][a[1]]}if(i)return i.getLastNode().getLastCell()}}},{key:"getNextCell",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=null,n=t,r=e;while(!a)if(r+1<this.col_num)r++,a=this.data[n][r];else{if(!(n+1<this.row_num))break;n++,r=0,a=this.data[n][r]}if(a)return i?a.getFirstNode().getFirstCell():a.getLastNode().getLastCell()}},{key:"getPrevCell",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=null,n=t,r=e;while(!a)if(r>0)r--,a=this.data[n][r];else{if(!(n>0))break;n--,r=this.col_num-1,a=this.data[n][r]}if(a)return i?a.getFirstNode().getFirstCell():a.getLastNode().getLastCell()}},{key:"get_merge_end_row",value:function(t,e){var i,a=Object(r["a"])(this.merged_cells);try{for(a.s();!(i=a.n()).done;){var n=i.value,l=n.split(":"),s=l[0].split("-"),o=l[1].split("-"),h=Number(s[0]),d=Number(s[1]),c=Number(o[0]);Number(o[1]);if(h===t&&d===e)return c}}catch(g){a.e(g)}finally{a.f()}return t}},{key:"get_row_end_x",value:function(t,e,i){var a=i[e+1];if(this.isMergeCells(t,e,!0))for(e++;e<this.col_num;e++){if(!this.isMergeCells(t,e))break;a=i[e+1]}else;return a}},{key:"get_row_end_y",value:function(t,e,i){var a,n=!1,l=Object(r["a"])(this.merged_cells);try{for(l.s();!(a=l.n()).done;){var s=a.value,o=s.split(":"),h=o[0].split("-"),d=o[1].split("-"),c=Number(h[0]),g=Number(h[1]),p=Number(d[0]);Number(d[1]);if(c===t&&g===e&&p>t){this.merge_row_y[p]?i>this.merge_row_y[p]&&(this.merge_row_y[p]=i):this.merge_row_y[p]=i,n=!0;break}}}catch(u){l.e(u)}finally{l.f()}return this.merge_row_y[t]?!n&&i>this.merge_row_y[t]?i:this.merge_row_y[t]:i}},{key:"drawBackground",value:function(){var t,e=null,i=Object(r["a"])(this.data);try{for(i.s();!(t=i.n()).done;){var a,n=t.value,l=Object(r["a"])(n);try{for(l.s();!(a=l.n()).done;){var s,o=a.value;e=null===o||void 0===o?void 0:o.table_cell,null!==(s=e)&&void 0!==s&&s.select&&L.drawBackground(e.page_idx,[{start:e.begin,end:e.end}])}}catch(h){l.e(h)}finally{l.f()}}}catch(h){i.e(h)}finally{i.f()}}}]),i}(M),B=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Object(h["a"])(this,t),this.id=e,this.first=null,this.last=null,this.page_idx=0,this.page_idx_end=0}return Object(d["a"])(t,[{key:"insert",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e.parent=t.parent;var a=t.prev,n=t.next;i?(a?(a.next=e,e.prev=a):this.first=e,e.next=t,t.prev=e):(t.next=e,e.prev=t,n?(e.next=n,n.prev=e):this.last=e),e.parent_seq=this}},{key:"append",value:function(t){t&&(this.first?(this.last.next=t,t.prev=this.last,this.last=t):(this.first=t,this.last=t),t.parent_seq=this)}},{key:"delete",value:function(t){if(!t)return t;var e=t.prev,i=t.next;return e||i?i?e?(e.next=i,i.prev=e):(this.first=i,i.prev=null):(e.next=null,this.last=e):(this.first=null,this.last=null),t=null,e||i}},{key:"clear",value:function(){this.first=null,this.last=null,this.dict={}}},{key:"getNodeByPos",value:function(t,e,i){var a=this.first,n=null;while(a){if(a.page_idx>t)break;if(a.page_idx===t||a.page_idx_end===t){if(n=a.isRange(t,e,i),n)return n;a=a.next}else a=a.next}return null}},{key:"getNodeLength",value:function(){var t=0,e=this.first;while(e)e=e.next,t++;return t}},{key:"getParagraphByPos",value:function(t,e,i){var a=this.getFirstNode();while(a){if(a.page_idx>t)break;if(a.page_idx_end<t);else if(a.isRange(t,e,i))return a;a=a.next}return null}},{key:"getCellByPos",value:function(t,e,i){var a=this.getFirstNode(),n=null,r=null,l=null;while(a){if(a.page_idx>t)break;if(a.page_idx_end<t);else if("paragraph"===a.type){if(a.isRange(t,e,i))return r=a.getCursorCell(t,e,i),r}else if("lite_table"===a.type)for(var s=0;s<a.cell_pos.length;s++)if(l=a.cell_pos[s],l.isRange(t,e,i))return n=new k(t,l.begin,new y(l.begin.x+a.space_left,l.end.y)),r=n.isRange(t,e,i)?a.getCursorCell(t,l.begin.x+a.space_left+2,i,l):a.getCursorCell(t,e,i,l),r||(r=a.getCursorCell(t,l.end.x-a.space_right-6,i,l)),r||(r=a.getLastCell(l)),r;a=a.next}return r}},{key:"getNodeById",value:function(t){var e=this.first;while(e){if(e.id===t)return e;e=e.next}}},{key:"getFirstNode",value:function(){return this.first}},{key:"getLastNode",value:function(){return this.last}},{key:"getPageLast",value:function(t){var e=this.first;while(e){if(e.page_idx===t)break;e=e.next}while(e&&e.next&&e.next.page_idx===t)e=e.next;return e}},{key:"getPrevNode",value:function(t){return null===t||void 0===t?void 0:t.prev}},{key:"getNextNode",value:function(t){return null===t||void 0===t?void 0:t.next}},{key:"getPrevCell",value:function(t){var e=t.paragraph,i=null===e||void 0===e?void 0:e.prev,a=null;return t.idx>0?a=e.cell_pos[t.idx-1]:i&&(a=i.getLastCell()),a}},{key:"getNextCell",value:function(t){var e=t.paragraph,i=null===e||void 0===e?void 0:e.next,a=null;return"paragraph"===t.node.type?i&&(a=i.getFirstCell(),a.latter=!1):(a=e.cell_pos[t.idx+1],a.latter=t.latter),a}},{key:"deletePrevCell",value:function(t){var e,i=t.paragraph,a=i.prev,n=t.node,r=t.idx,l=this.getPrevCell(t),s=t.paragraph.parent_seq;return"paragraph"===n.type&&1===i.cell_pos.length?(t=l,s.delete(i)):t.latter?"paragraph"===n.type?0===r?a&&(a.cell_pos.length>1?(t=a.cell_pos[a.cell_pos.length-1],a.runs.append(i.runs.first),s.delete(i)):s.delete(a)):(i.deleteCell(l),0===r?t.latter=!1:t.idx=r-1):"lite_table"===n.type||(i.deleteCell(t),0===r?t.latter=!1:t.idx=r-1):0===t.idx&&"lite_table"===(null===(e=t.node.prev)||void 0===e?void 0:e.type)||l&&(n=l.node,"paragraph"===n.type?0===l.idx?(s=l.paragraph.parent_seq,s.delete(n)):(a.runs.append(i.runs.first),t=a.cell_pos[a.cell_pos.length-2],t.latter=!0,s.delete(i)):(i.deleteCell(l),0===r?t.latter=!1:t.idx=r-1)),t}},{key:"deleteNextCell",value:function(t){var e=t.paragraph,i=e.next,a=e.prev,n=t.node,r=t.idx;if(t.latter&&"paragraph"!==t.node.type){var l=this.getNextCell(t);l&&(e=l.paragraph,i=e.next,n=l.node,r=l.idx,"paragraph"===n.type?0===r?i?this.delete(n):"paragraph"===l.node.type&&this.delete(l.node):i&&(e.runs.append(i.runs.first),this.delete(i)):"lite_table"===n.type||e.deleteCell(l))}else"paragraph"===t.node.type?0===t.idx?i?(this.delete(e),t=i.getFirstCell(),t.latter=!1):a||e.copyStyle():i&&(e.runs.append(i.runs.first),this.delete(i),t.latter=!1):e.deleteCell(t);return t}},{key:"deleteCell",value:function(t){var e=t.paragraph,i=e.next,a=e.prev,n=t.node,r=t.idx,l=this.getPrevCell(t);return"paragraph"===n.type?0===r?this.delete(e):i?(e.runs.append(i.runs.first),this.delete(i)):a&&(a.cell_pos.length>1?a.deleteCell(a.cell_pos[a.cell_pos.length-1]):(a.runs.append(e.runs.first),this.delete(e))):e.deleteCell(t),l}},{key:"getPageFirstNode",value:function(t){var e=this.first;while(e){if(e.page_idx===t||e.page_idx_end===t)return e;e=e.next}return null}},{key:"merge",value:function(t){"text"===t.type?this.mergeText(t):"image"===t.type?this.mergeImage(t):"lite_table"===t.type&&this.mergeTable(t)}},{key:"mergeText",value:function(t){var e;if("text"!==t.type||""!==t.text){var i=c["d"].g_cursor,a=i.paragraph,n=i.node,r=i.latter,l=null,s=null;if("paragraph"===(null===(e=n)||void 0===e?void 0:e.type)&&(n=a.runs.getLastNode(),i=n?n.getLastCell():i,r=!0),null===n)a.runs.append(t),i=a.cell_pos[0],i.idx=t.text.length,i.latter=!0;else if("text"===n.type)if(""===n.text)n.text=t.text,n.copyStyle(t),i.idx+=t.text.length;else if(n.equal(t))l=n.text,r?(n.text=l.slice(0,i.run_idx+1),s=l.slice(i.run_idx+1),n.text=n.text+t.text+s):(n.text=l.slice(0,i.run_idx),s=l.slice(i.run_idx),n.text=n.text+t.text+s),i.idx+=t.text.length;else{if(l=n.text,r?(n.text=l.slice(0,i.run_idx+1),s=l.slice(i.run_idx+1)):(n.text=l.slice(0,i.run_idx),s=l.slice(i.run_idx)),a.runs.insert(n,t),s.length>0){var o=new D(l=s,n.font,n.bg,n.href);a.runs.insert(t,o)}""===n.text&&a.runs.delete(n),i.idx+=t.text.length}c["d"].g_cursor=i}}},{key:"mergeImage",value:function(t){var e=g_cursor.node,i=null;if("row"===e.type)this.insert(e,t,!0);else if("text"===e.type)if(0===g_cursor.idx)this.insert(e,t,!0);else if(g_cursor.idx>=e.text.length)this.insert(e,t);else{var a=e.text;e.text=a.slice(0,g_cursor.idx),this.insert(e,t),i=new D(a.slice(g_cursor.idx),e.font,e.bg,e.href),this.insert(t,i)}else"image"===e.type&&this.insert(e,t)}},{key:"mergeTable",value:function(t){var e=c["d"].g_cursor,i=e.paragraph,a=e.node,n=null,r=a.prev,l=a.parent,s=null;if(!l||"lite_table"!==l.type)if("image"===a.type)a.id===l.first.id?this.insert(l,t,!0):(n=new T(l.font||(null===r||void 0===r?void 0:r.font)),n.first=l.first,n.last=a.prev,n.last.last=null,l.first=a,a.prev=null,this.insert(l,t,!0),this.insert(t,paragraph2,!0));else if("lite_table"===a.type);else if("paragraph"===a.type)this.insert(a,t),n=new T,n.copyStyle(i),this.insert(t,n),a.cell_pos.length<2&&this.delete(a);else if("text"===a.type)if(0===e.run_idx)this.insert(i,t,!0),1!==i.runs.getNodeLength()&&this.insert(t,new T);else if(e.run_idx+1>=a.text.length)this.insert(i,t),n=new T,n.copyStyle(i),this.insert(t,n);else{var o,h=a.text;a.text=h.slice(0,e.run_idx+1),s=new D(h.slice(e.run_idx+1)),s.copyStyle(a),s.next=a.next,a.next=null,n=new T((null===l||void 0===l?void 0:l.font)||(null===(o=s)||void 0===o?void 0:o.font)),n.runs.append(s),this.insert(i,t),this.insert(t,n)}}}]),t}(),O=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:794,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1123,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:96,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:96,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:120,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:120,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:57,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:66;Object(h["a"])(this,t),this.page_width=e,this.page_height=i,this.bg_color=s,this.left_margin=r,this.right_margin=l,this.top_margin=a,this.bottom_margin=n,this.header_distance=o,this.footer_distance=d,this.content_width=this.page_width-this.left_margin-this.right_margin,this.content_height=this.page_height-this.top_margin-this.bottom_margin,this.paragraph_symbol={},this.line_type=null,this.line_pitch=null,this.max_page=1,this.opera_cell=null,this.node_id=null,this.file_url=null,this.file_name=null,this.file_path=null},R=21,I={recalculate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,i=c["d"].g_cursor,a=c["d"].g_cursor_end,n=c["d"].g_word_page;o["a"].isNull(t)&&(t=0,i&&(t=i.page_idx-1||0),a&&a.page_idx<i.page_idx&&(t=a.page_idx)),t<0&&(t=0),console.log("recalculate: page_idx:"+t+" num:"+e);var r=t+e,l=c["d"].g_seq_paragraph.getPageFirstNode(t);if(c["a"]&&l)for(var s=l.page_idx;s<r;s++)L.clearPage(s);var h=new y(n.left_margin,n.top_margin),d=0,g=!0;while(l){if(l.page_idx_end=l.page_idx,h=l.calcPosition(h),l.next&&(l.next.page_idx=l.page_idx_end,l.next.page_idx_end=l.page_idx_end),d=l.page_idx_end,l.page_idx_end>r){g=!1;break}l=l.next}return g?n.max_page=d+1:o["a"].isNull(n.max_page)&&(n.max_page=d),i&&(c["d"].g_cursor=z["a"].locateCursor(i)),a&&(c["d"].g_cursor_end=z["a"].locateCursor(a)),n},click:function(t,e,i){var a,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];L.clearBackground();var r=c["d"].g_word_page;e<r.left_margin?e=r.left_margin+2:e>r.page_width-r.right_margin&&(e=r.page_width-r.right_margin-2),i<r.top_margin?i=r.top_margin+2:e>r.page_height-r.top_margin&&(i=r.page_height-r.top_margin-2);var l=c["d"].g_seq_paragraph,s=l.getCellByPos(t,e,i);if(!s){var o=l.getPageLast(t);o&&(s=o.cell_pos[o.cell_pos.length-1])}if(s)if(n&&0!==s.compare(c["d"].g_cursor))c["d"].g_cursor_end=s,L.drawBackgroundByCell(c["d"].g_cursor,c["d"].g_cursor_end);else{var h=s.bg_end.x-s.bg_begin.x;"paragraph"===s.node.type||e<s.bg_begin.x+h/2?s.latter=!1:s.latter=!0,c["d"].g_cursor=s,c["d"].g_cursor_end=null,L.drawCursorByCell(c["d"].g_cursor)}else n||(c["d"].g_cursor_end=null);return console.log("click: page_idx="+t+" x="+e+" y="+i+" text_idx="+(null===(a=s)||void 0===a?void 0:a.idx)),this.operaReturn()},operaReturn:function(){var t=c["d"].g_cursor,e=c["d"].g_cursor_end,i=c["d"].g_word_page,a=null;a=e||t,a.page_idx+1>(i.max_page||1)&&(i.max_page=a.page_idx+1);var n=a.node,r=a.paragraph;return"paragraph"!==n.type&&(n.horizontal=r.horizontal),c["d"].g_word_page.opera_cell=a,c["d"].g_word_page=i,i},save:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t&&setTimeout((function(){t()}),1e3);var e=new FormData;e.append("chapter_file_id","1")},copy:function(){},paste:function(t){try{var e=new Date,i=c["d"].g_seq_paragraph,a=c["d"].g_cursor,n=c["d"].g_cursor_end;n&&(a=A(a,n),a||(a=i.getFirstNode().getFirstCell()),c["d"].g_cursor=a,c["d"].g_cursor_end=null);var r=null,l=a.node,s=[];if(t.indexOf("\n")>-1&&(s=o["a"].StrEx(t).split("\n")),s.length>1)for(var h=0;h<s.length;h++)r=new D(s[h]),("text"===l.type||l.next&&"text"===l.next.type)&&r.copyStyle(l),0===h||(s.length,this.enter()),i.merge(r);else r=new D(t),l=a.node,("text"===l.type||l.next&&"text"===l.next.type)&&r.copyStyle(l),i.merge(r);var d=new Date;console.log(d-e),this.recalculate()}catch(d){console.log(d.stack)}return this.operaReturn()},select:function(t,e,i){try{var a=null,n=null,r=c["d"].g_seq_paragraph;e<c["d"].g_word_page.left_margin&&(e=c["d"].g_word_page.left_margin+2),console.log("select:cursor.idx="+c["d"].g_cursor.idx+" cursor.latter="+c["d"].g_cursor.latter);var l=r.getParagraphByPos(t,e,i);l||(a=c["d"].g_cursor_end||c["d"].g_cursor,i=a.begin.y+2,l=r.getParagraphByPos(t,e,i)),l&&(n=l.getCursorCell(t,e,i),n&&(c["d"].g_cursor_end=n,"paragraph"===n.node.type||e<n.end.x-2?c["d"].g_cursor_end.latter=!1:c["d"].g_cursor_end.latter=!0))}catch(s){console.log(s.stack)}c["d"].g_cursor&&c["d"].g_cursor_end&&(console.log("select:cursor_end.idx="+c["d"].g_cursor_end.idx+" g_cursor_end.latter="+c["d"].g_cursor_end.latter),c["d"].g_cursor_height=0,L.drawBackgroundByCell(c["d"].g_cursor,c["d"].g_cursor_end))},input:function(t){try{var e,i=c["d"].g_cursor,a=c["d"].g_cursor_end,n=i.paragraph.parent_seq||c["d"].g_seq_paragraph;a&&(i=A(i,a),i||(i=n.getFirstNode().getFirstCell()),c["d"].g_cursor=i,c["d"].g_cursor_end=null),"transparent"===(null===(e=t.bg)||void 0===e?void 0:e.color)&&(t.bg.color=null),n.merge(t),this.recalculate()}catch(r){console.log(r.stack)}return this.operaReturn()},enter:function(){var t=c["d"].g_cursor,e=c["d"].g_cursor_end,i=c["d"].g_seq_paragraph;e&&(t=A(t,e),t||(t=i.getFirstNode().getFirstCell()),c["d"].g_cursor_end=null);var a=t.node,n=t.paragraph,r=null,l=null;if("paragraph"===a.type)1===n.cell_pos.length&&n.paragraph_symbol?(n.paragraph_symbol=null,n.paragraph_abstract_id=null):(i=n.parent_seq,r=new T,r.copyStyle(n),i.insert(a,r));else if("text"===a.type){r=new T,n=t.paragraph,r.copyStyle(n);var s=a.text;if(t.latter?(a.text=s.slice(0,t.run_idx+1),s=s.slice(t.run_idx+1)):(a.text=s.slice(0,t.run_idx),s=s.slice(t.run_idx)),l=a.next,a.next=null,""===a.text?n.runs.delete(a):n.runs.last=a,""!==s){var o=new D(s);o.copyStyle(a),o.parent=r,r.runs.append(o),l&&r.runs.append(l)}else l&&r.runs.append(l);i=n.parent_seq,i.insert(n,r)}else a.type;return this.recalculate(),t=r?r.getFirstCell():n.getFirstCell(),t.latter=!1,c["d"].g_cursor=t,this.operaReturn()},delete:function(){try{var t=c["d"].g_cursor,e=c["d"].g_cursor_end;if(e)c["d"].g_cursor=A(t,e),c["d"].g_cursor_end=null;else{var i=t.paragraph.parent_seq||c["d"].g_seq_paragraph;c["d"].g_cursor=i.deleteNextCell(t)}var a=t.page_idx-1;return this.recalculate(a),this.operaReturn()}catch(n){console.log(n.stack)}},backspace:function(){try{var t=c["d"].g_cursor,e=c["d"].g_cursor_end;if(e)c["d"].g_cursor=A(t,e),c["d"].g_cursor_end=null;else{var i=t.paragraph.parent_seq||c["d"].g_seq_paragraph;c["d"].g_cursor=i.deletePrevCell(t)}var a=t.page_idx-1;return this.recalculate(a),this.operaReturn()}catch(n){console.log(n.stack)}},keyDown:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{var i=c["d"].g_cursor,a=c["d"].g_cursor_end,n=a||i,r=null,l=c["d"].g_seq_paragraph,s=z["a"].getBeginCell(i,a),o=s[0],h=s[1];if(a&&!e&&[35,36,37,39].indexOf(t)>-1)i=[36,37].indexOf(t)>-1?o.copy():h.copy(),"paragraph"===i.node.type&&(i.latter=!1);else if(!e&&0===o.idx&&o.latter&&37===t&&"paragraph"!==i.node.type)i.latter=!1;else if(!e||a||39!==t||i.latter&&"paragraph"!==i.node.type){var d=n.paragraph,g=null===d||void 0===d?void 0:d.parent,p=null,u=null;switch(t){case 35:r=z["a"].move(n,"end");break;case 36:r=z["a"].move(n,"home");break;case 37:r=l.getPrevCell(n),r&&r.id!==n.id||"lite_table"!==(null===g||void 0===g?void 0:g.type)||(s=g.getMergeFirst(d.row_idx,d.col_idx),p=s[0],u=s[1],r=0===p&&0===u&&g.prev?g.prev.getLastCell():g.getPrevCell(p,u));break;case 38:r=z["a"].move(n,"up");break;case 39:r=l.getNextCell(n),r&&r.id!==n.id||"lite_table"!==(null===g||void 0===g?void 0:g.type)||(s=g.getMergeFirst(d.row_idx,d.col_idx),p=s[0],u=s[1],r=p===g.row_num-1&&u===g.col_num-1&&g.next?g.next.getFirstCell():g.getNextCell(p,u));break;case 40:r=z["a"].move(n,"down");break;default:return}if(e){switch(t){case 35:r&&(a=r,a.latter=!0);break;case 36:r&&(a=r,a.latter=!1);break;case 37:r?(a=r,c["d"].g_cursor_end?a.latter=o.latter:a.latter=i.latter):a.latter=!1;break;case 38:r&&(a=r,"paragraph"===r.node.type?a.latter=!1:a.latter=!0);break;case 39:r&&(a=r,c["d"].g_cursor_end?a.latter=h.latter:a.latter=i.latter);break;case 40:r&&(a=r,a.latter=!0);break;default:break}a&&i.compareCursor(a,i.latter,a.latter)?(c["d"].g_cursor=i,c["d"].g_cursor_end=null):c["d"].g_cursor_height=0}else switch(t){case 35:r?(i=r,i.latter=!0):i=o;break;case 36:r&&(i=r,i.latter=!1);break;case 37:r?(i=r,"paragraph"===o.node.type?i.latter=!1:i.latter=o.latter):i=o;break;case 38:r?(i=r,"paragraph"===o.node.type?i.latter=!1:i.latter=!0):i=o;break;case 39:r?(i=r,"paragraph"===i.node.type&&(i.latter=!1)):h&&(i=h),"paragraph"===i.node.type&&(i.latter=!1);break;case 40:r?(i=r,"paragraph"===o.node.type?i.latter=!1:i.latter=!0):h&&(i=h);break;default:break}}else a=i.copy(),a.latter=!0,i.latter=!1;c["d"].g_cursor=i,e||(a=null),c["d"].g_cursor_end=a,c["d"].g_cursor_end?L.drawBackgroundByCell(c["d"].g_cursor,c["d"].g_cursor_end):(L.clearBackground(),L.drawCursorByCell(c["d"].g_cursor))}catch(_){console.log(_.stack)}return this.operaReturn()},back:function(){return this.operaReturn()},forward:function(){return this.operaReturn()},formatBrush:function(t){},formatClear:function(){var t=null;if(c["d"].g_cursor_end)t=new D("",c["e"]),this.operaText(t);else{t=c["d"].g_cursor.node,"row"===t.type&&(t.formatClear(),t=t.prev);while(t&&"row"!==t.type)t.formatClear(),t=t.prev;while(t&&"row"!==t.type)t.formatClear(),t=t.next}return this.operaReturn()},align:function(t){var e=c["d"].g_cursor,i=c["d"].g_cursor_end;if(i){var a=z["a"].getBeginCell(e,i),n=a[0],r=a[1],l=n.paragraph,s=r.paragraph,o=l;while(o){if(o.horizontal=t,o.id===s.id)break;o=o.next}}else e.paragraph.horizontal=t;return this.recalculate(),this.operaReturn()},lineSpacing:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,i=c["d"].g_cursor,a=c["d"].g_cursor_end;if(a){var n=z["a"].getBeginCell(i,a),r=n[0].paragraph,l=n[1].paragraph,s=r;while(s){if("lite_table"===s.type||(s.line_spacing=t,s.line_spacing_rule=e),s.id===l.id)break;s=s.next}}else i.paragraph.line_spacing_rule=e,i.paragraph.line_spacing=t;return this.recalculate(),this.operaReturn()},indentation:function(t){var e=c["d"].g_cursor,i=c["d"].g_cursor_end,a=R,n=c["d"].g_word_page,r=0,l=n.page_width-n.left_margin-n.right_margin-a;function s(e){e.paragraph_symbol?1===e.paragraph_serial?(e.left_indent+=a*t,e.left_indent=e.left_indent<r?r:e.left_indent,e.left_indent=e.left_indent>l?l:e.left_indent):e.left_indent+a*t>l||e.left_indent+a*t<r||(e.paragraph_level=e.paragraph_level+t,e.left_indent+=a*t):(e.left_indent+=a*t,e.left_indent=e.left_indent<r?r:e.left_indent,e.left_indent=e.left_indent>l?l:e.left_indent)}if(i){var o=z["a"].getBeginCell(e,i),h=o[0].paragraph,d=o[1].paragraph,g=h;while(g){if(s(g),g.id===d.id)break;g=g.next}}else s(e.paragraph);return this.recalculate(),this.operaReturn()},paragraphSymbol:function(t){return this.paragraphFormat(t)},paragraphFormat:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=null,i=null,a=null,n=null,r=null,l=[];if(c["d"].g_cursor_end){var s=z["a"].getBeginCell(c["d"].g_cursor,c["d"].g_cursor_end);i=c["d"].g_seq_paragraph.getParagraphNode(s[0].cell.node),a=c["d"].g_seq_paragraph.getParagraphNode(s[1].cell.node),i.paragraph_symbol=t,null===i.paragraph_level&&(i.paragraph_level=0),a.paragraph_symbol=t,null===a.paragraph_level&&(a.paragraph_level=0),l.push(i.id),l.push(a.id),e=i.next;while(e&&e.id!==a.id)n=c["d"].g_seq_paragraph.getParagraphNode(e),n&&l.indexOf(n.id)<0&&(n.paragraph_symbol=t,null===n.paragraph_level&&(n.paragraph_level=0)),e=e.next}else if(r=c["d"].g_cursor.paragraph,r.paragraph_symbol=t,r.paragraph_abstract_id=null===t||void 0===t?void 0:t.abstract_id,t){var o=r.paragraph_abstract_id;if(null!==o){r=c["d"].g_cursor.paragraph.prev;while(r){if((r.paragraph_abstract_id===o||r.paragraph_symbol.abstract_id===o)&&(r.paragraph_symbol=t,r.paragraph_abstract_id=t.abstract_id,1===r.paragraph_serial))break;r=r.prev}r=c["d"].g_cursor.paragraph.next;while(r){if(r.paragraph_abstract_id===o||r.paragraph_symbol.abstract_id===o)r.paragraph_symbol=t,r.paragraph_abstract_id=t.abstract_id;else if(null!==r.paragraph_abstract_id&&0===r.paragraph_level&&r.paragraph_abstract_id!==o)break;r=r.next}}}return this.recalculate(),this.operaReturn()},operaText:function(t){try{var e=c["d"].g_cursor,i=c["d"].g_cursor_end;if(t.horizontal=null,i||"paragraph"!==e.node.type||1!==e.node.cell_pos.length){var a,n,r,l=z["a"].getBeginCell(e,i),s=l[0],o=l[1],h=null;s.latter&&(h=s.paragraph.parent_seq,s=h.getNextCell(s)),null!==(a=o)&&void 0!==a&&a.latter||(h=o.paragraph.parent_seq,o=h.getPrevCell(o));var d=null===(n=s)||void 0===n?void 0:n.paragraph,g=null===(r=o)||void 0===r?void 0:r.paragraph,p=null===d||void 0===d?void 0:d.next;if(d.id===(null===g||void 0===g?void 0:g.id))d.copyTextStyle(t,s,o);else{d.copyTextStyle(t,s);while(p){if(p.id===(null===g||void 0===g?void 0:g.id)){g.copyTextStyle(t,null,o);break}p.copyTextStyle(t),p=p.next}}}else e.node.copyStyle(t);this.recalculate()}catch(u){console.log(u.stack)}return this.operaReturn()},operaTextSize:function(t){if(c["d"].g_cursor_end){var e=z["a"].getBeginCell(c["d"].g_cursor,c["d"].g_cursor_end);e[0].cell,e[1].cell;return this.recalculate(),this.operaReturn()}},operaImage:function(t){var e=c["d"].g_seq_paragraph.getNode(t.id);if(e)return e.width=t.width,e.height=t.height,e.calcSize(),this.recalculate(),c["d"].g_seq_paragraph.opera_node=e,this.operaReturn()},operaTable:function(t,e){var i,a,n=[],r=null,l=null,s=null;switch(t){case"row_height":n=e.id.split("-"),r=c["d"].g_seq_paragraph.getNodeById(n[0]);var o=Number(n[2]);if(r&&null!==(i=r)&&void 0!==i&&i.data){var h=r.data.length;0===o||(o===h?(l=r.data[o-1][0].table_cell,s=e.node_begin.y-l.node_end.y,r.min_row_height[o-1]||(r.min_row_height[o-1]=0),r.min_row_height[o-1]+=s):(l=r.data[o][0].table_cell,s=e.node_begin.y-l.node_begin.y,r.min_row_height[o-1]||(r.min_row_height[o-1]=0),r.min_row_height[o-1]+=s))}break;case"col_width":n=e.id.split("-"),r=c["d"].g_seq_paragraph.getNodeById(n[0]);var d=Number(n[2]);if(r&&null!==(a=r)&&void 0!==a&&a.data){var g=r.data[0].length;if(0===d);else if(d===g);else{l=r.data[0][d].table_cell;var p=e.node_begin.x-l.node_begin.x;r.col_width[d-1]+=p,r.col_width[d]-=p}}break;case"merge_cells":break;case"add_row":break;case"add_col":break}return this.recalculate(),this.operaReturn()},insertTable:function(t){try{var e=c["d"].g_cursor,i=e.node;if(c["d"].g_cursor_end||"image"===i.type)return;var a=t.y,n=t.x,r=c["d"].g_word_page,l=null,s=null,o=new H;o.data=[],o.page_idx=i.page_idx,o.merged_cells=["1-1:4-4","5-0:5-5"];for(var h=r.content_width/n,d=0;d<n;d++)o.col_width[d]=h;for(var g=[],p=0;p<a;p++){g=[];for(var u=0;u<n;u++)s=new T(null===i||void 0===i?void 0:i.font),s.parent=o,l=new B("cell-"+p+"-"+u),l.append(s),g.push(l);o.data.push(g)}c["d"].g_seq_paragraph.merge(o),this.recalculate(),o.data&&(e=o.data[0][0].getFirstNode().getFirstCell(),e.latter=!1),c["d"].g_cursor=e}catch(_){console.log(_.stack)}return this.operaReturn()},insertImage:function(t){return c["d"].g_seq_paragraph.merge(t),this.recalculate(),c["d"].g_cursor=t.cell_pos[0],c["d"].g_seq_paragraph.opera_node=t,this.operaReturn()},operaPage:function(){return this.recalculate(),this.operaReturn()},export:function(t,e){var i=[];try{i=this.toVAdmin(),g_word_page.opera_cell=null;var a={};a.width=c["d"].g_word_page.width,a.height=c["d"].g_word_page.height,a.left_margin=c["d"].g_word_page.left_margin,a.right_margin=c["d"].g_word_page.right_margin,a.top_margin=c["d"].g_word_page.top_margin,a.bottom_margin=c["d"].g_word_page.bottom_margin,a.file_name=c["d"].g_word_page.file_name,a.file_path=c["d"].g_word_page.file_path;var n={lst_node:JSON.stringify(i),page:JSON.stringify(a)};Object(s["a"])({method:"post",url:t,params:n}).then((function(t){e(t)})).catch((function(){e()}))}catch(r){console.log(r.stack),e()}},toVAdmin:function(){var t=[],e={},i=null,a=c["d"].g_seq_paragraph.getFirst();function n(t){var e={};if(e.type=null===t||void 0===t?void 0:t.type,"text"===(null===t||void 0===t?void 0:t.type))e.text=t.text,t.horizontal&&"left"!==t.horizontal&&(e.horizontal=t.horizontal),t.text&&!c["d"].g_word_page.file_name&&(c["d"].g_word_page.file_name=t.text.slice(0,10)),t.font&&(e.font=JSON.parse(JSON.stringify(t.font))),t.bg&&(e.bg=JSON.parse(JSON.stringify(t.bg)));else if("paragraph"===(null===t||void 0===t?void 0:t.type)){t.horizontal&&"left"!==t.horizontal&&(e.horizontal=t.horizontal),t.first_line_indent&&(e.first_line_indent=t.first_line_indent),t.left_indent&&(e.left_indent=t.left_indent),t.right_indent&&(e.right_indent=t.right_indent),o["a"].isNull(t.line_spacing_rule)||(e.line_spacing=t.line_spacing,e.line_spacing_rule=t.line_spacing_rule),t.space_before&&(e.space_before=t.space_before),t.space_after&&(e.space_after=t.space_after),t.font&&(e.font=JSON.parse(JSON.stringify(t.font))),e["children"]=[];var i=t.first;while(i)e["children"].push(n(i)),i=i.next}else null===t||void 0===t||t.type;return e}while(a){if(e={},e.type=a.type,"lite_table"===a.type){for(var r=[],l=[],s=[],h=0;h<a.data.length;h++){var d=a.data[h];l=[];for(var g=0;g<d.length;g++){s=[],i=d[g];while(i)s.push(n(i)),i=i.next;l.push(s)}r.push(l)}e.data=r,e.col_width=a.col_width,e.merged_cells=a.merged_cells,e.row_height=a.row_height,a.left_indent&&(e.left_indent=a.left_indent),e.cell_horizontal=a.cell_horizontal,e.cell_vertical=a.cell_vertical}else e=n(a);t.push(e),a=a.next}return t},toWord:function(t){var e,i=null,a=null;function n(t){var e=null;if("text"===t.type)e=new D(t.text,t.font,t.bg,t.href);else if("paragraph"===t.type){e=new T(null===t||void 0===t?void 0:t.font),e.horizontal=(null===t||void 0===t?void 0:t.horizontal)||"left",e.left_indent=t.left_indent||0,e.right_indent=t.right_indent||0,e.first_line_indent=t.first_line_indent||0,e.line_spacing=t.line_spacing||0,e.line_spacing_rule=t.line_spacing_rule||0,e.space_before=t.space_before,e.space_after=t.space_after,e.paragraph_abstract_id=t.paragraph_abstract_id,e.paragraph_level=t.paragraph_level;for(var i=0;i<t.children.length;i++)w=t.children[i],a=n(w),e.runs.append(a)}else"image"===t.type&&(e=new WordImage(null,t.width,t.height,t.data));return e}if(this.initGlobal(t),t&&(null===(e=t.children)||void 0===e?void 0:e.length)>0){c["d"].g_word_page=t;var l,s=Object(r["a"])(t.children);try{for(s.s();!(l=s.n()).done;){var o=l.value;if(["table","lite_table"].indexOf(o.type)>-1){var h=null,d=null,g=null,p=null,u=new H([],o.merged_cells,o.col_width);if(o.data){var _=u.row_num=o.data.length,v=u.col_num=o.data[0].length,f=null,w=null,m=[];for(h=0;h<_;h++){for(m=[],d=0;d<v;d++){var x;if(f=o.data[h][d],g=new B("cell-"+h+"-"+d),(null===(x=f)||void 0===x?void 0:x.length)>0){var b,y=Object(r["a"])(f);try{for(y.s();!(b=y.n()).done;)w=b.value,p=n(w),p.parent=u,g.append(p)}catch($){y.e($)}finally{y.f()}}else p=new T,p.parent=u,g.append(p);m.push(g)}u.data.push(m)}}c["d"].g_seq_paragraph.append(u)}else{var k=n(o);c["d"].g_seq_paragraph.append(k)}}}catch($){s.e($)}finally{s.f()}}else i=new T(c["e"]),c["d"].g_seq_paragraph.append(i);var C=c["d"].g_word_page;C.paragraph_bullet={},C.paragraph_number={};var S=[new F("bullet","&#9670","1001"),new F("bullet","&#10148","1002"),new F("bullet","&#10003","1003"),new F("bullet","&#10140","1004"),new F("bullet","&#9641","1005"),new F("bullet","&#10026","1006"),new F("bullet","&#10022","1007")],z=[new F("decimal","%s.","2001"),new F("decimal","%s)","2002"),new F("chineseCountingThousand","%s、","2003"),new F("upperLetter","%s.","2004"),new F("chineseCountingThousand","%s)","2005"),new F("lowerLetter","%s)","2006"),new F("lowerLetter","%s.","2007")],L=null,M=[],P=[],N=[],O=[],R=[];for(var I in null===t||void 0===t?void 0:t.paragraph_symbol)M=t.paragraph_symbol[I],M.length>0&&(L=M[0],L.child=M.slice(1),"bullet"===L.type?(N.indexOf(L.id)<0?C.paragraph_bullet[L.abstract_id]=L:R.push(L),N.push(L.id)):(O.indexOf(L.id)<0?C.paragraph_number[L.abstract_id]=L:R.push(L),O.push(L.id)));if(N.length<7)for(var A=0;A<S.length;A++)L=S[A],N.indexOf(L.id)>-1||(P=JSON.parse(JSON.stringify(S)),P.splice(A,1),L.child=P,C.paragraph_bullet[L.abstract_id]=L);if(O.length<7)for(var j=0;j<z.length;j++)L=z[j],O.indexOf(L.id)>-1||(P=JSON.parse(JSON.stringify(S)),P.splice(j,1),L.child=P,C.paragraph_number[L.abstract_id]=L);for(var E=0,V=R;E<V.length;E++)L=V[E],"bullet"===L.type?C.paragraph_bullet[L.abstract_id]=L:C.paragraph_number[L.abstract_id]=L;c["d"].g_cursor_end=null,this.recalculate(0,2);var q=c["d"].g_seq_paragraph.getFirstNode().getFirstCell();return q.latter=!1,c["d"].g_cursor=q,this.operaReturn()},initGlobal:function(t){c["d"].g_id_count=0,c["d"].g_paragraph_count=0,c["d"].g_seq_paragraph=new B,c["d"].g_seq_header=new B,c["d"].g_seq_footer=new B,c["d"].g_word_page=new O,c["d"].default_size=z["a"].get_font_size("A",c["e"]["size"],c["e"]["family"]),c["d"].default_size_chinese=z["a"].get_font_size("中",c["f"]["size"],c["f"]["family"]),c["d"].default_reg_chinese=new RegExp("[\\u4E00-\\u9FFF]+","g"),L.getPageDom.dom=null,L.getPageDom.page_dom={}}};function A(t,e){var i=z["a"].getBeginCell(t,e),a=i[0],n=i[1],r=a,l=null,s=null,o=null;if(a.compareCursor(n,a.latter,n.latter))return a;var h=c["d"].g_seq_paragraph;if(n.latter){l=n;var d=h.getLastNode(),g=d.getLastCell();l.id===g.id&&(d.font={},d.bg={},d.line_spacing_rule=0,d.line_spacing=0,d.left_indent=0,d.right_indent=0,l=h.getPrevCell(n))}else l=h.getPrevCell(n);var p=null;a.latter?p=a.id:(s=h.getPrevCell(a),s&&(r=s,r.latter=!0,p=s.id),0===a.idx&&(o=h.getNextCell(r),o&&(r.cursor_use_next=!0)));while(l){var u;if(s=h.deleteCell(l),(null===(u=s)||void 0===u?void 0:u.id)===p)break;l=s}return r}var j=i("1a43"),E=i("a83f"),V=i("13e7"),q={name:"word",mixins:[E["a"]],props:{page_width:{default:794},page_height:{default:1123},export_url:{default:String()},import_url:{default:String()},is_export_word:{default:!0},is_export_pdf:{default:!0},is_import_word:{default:!0},is_print:{default:!0},is_show_toolbar:{default:!0},is_save:{default:!0},is_insert:{default:!0},left_margin:{default:120},right_margin:{default:120},top_margin:{default:96},bottom_margin:{default:96},header_distance:{default:57},footer_distance:{default:66},paragraph_bullet:{default:null},paragraph_number:{default:null}},data:function(){return{print_value:"",err_text:"",printList:[{value:1,label:"全部"},{value:2,label:"当前页"},{value:3,label:"指定页"}],printType:1,showPrint:!1,isPrint:!1,nowScale:100,nav1:!1,nav2:!1,nav3:!1,nav4:!0,nav5:!1,nav6:!1,nav_paragraph_bullet:!1,nav_paragraph_number:!1,path1:"",path2:"",path3:"",path4:"",path_header:"",path_footer:"",isEditHead:!1,touchTime:null,left_margin_view:0,top_margin_view:0,timerOut:null,currentPage_view:1,inputDom:null,chinese_start:!1,outTimer:null,page_space:20,show_page_idx:[],page_number:1,begin_page_idx:0,current_page_idx:0,show_begin_y:0,show_end_y:0,cursor_page_idx:0,cursor_cell:null,cursor_y:0,show_page_number:1,update_page_number:1,old_update_page_number:1,input_timer:null,input_text:"",view_height:0,viewBoxDom:null,old_scroll_y:0,old_page_idx:0,scroll_timer:null,cursor_timer:null,mouse_timer:null,mouse_down:!1,italic:null,bold:null,underline:null,line_through:null,font_size:14,font_color:"#000000",bg_color:null,options_font_color:[[{color:"#FFFFFF"},{color:"#000000"},{color:"#E7E6E6"},{color:"#44546A"},{color:"#5B9BD5"},{color:"#ED7D31"},{color:"#A5A5A5"},{color:"#FFC000"},{color:"#4472C4"},{color:"#70AD47"}],[{color:"#F2F2F2"},{color:"#808080"},{color:"#D0CECE"},{color:"#D6DCE5"},{color:"#DEEBF7"},{color:"#FBE5D6"},{color:"#EDEDED"},{color:"#FFF2CC"},{color:"#DAE3F3"},{color:"#E2F0D9"}],[{color:"#D9D9D9"},{color:"#595959"},{color:"#AFABAB"},{color:"#ADB9CA"},{color:"#BDD7EE"},{color:"#F8CBAD"},{color:"#DBDBDB"},{color:"#FFE699"},{color:"#B4C7E7"},{color:"#C5E0B4"}],[{color:"#BFBFBF"},{color:"#404040"},{color:"#767171"},{color:"#8497B0"},{color:"#9DC3E6"},{color:"#F4B183"},{color:"#C9C9C9"},{color:"#FFD966"},{color:"#8FAADC"},{color:"#A9D18E"}],[{color:"#A6A6A6"},{color:"#262626"},{color:"#3B3838"},{color:"#333F50"},{color:"#2E75B6"},{color:"#C55A11"},{color:"#7C7C7C"},{color:"#BF9000"},{color:"#2F5597"},{color:"#548235"}],[{color:"#7F7F7F"},{color:"#0D0D0D"},{color:"#181717"},{color:"#222A35"},{color:"#1F4E79"},{color:"#843C0B"},{color:"#535353"},{color:"#7F6000"},{color:"#203864"},{color:"#385723"}]],options_font_color_bz:[[{color:"#C00000"},{color:"#FF0000"},{color:"#FFC000"},{color:"#FFFF00"},{color:"#92D050"},{color:"#00B050"},{color:"#00B0F0"},{color:"#0070C0"},{color:"#002060"},{color:"#7030A0"}]],options_bg_color:[[{color:"#FFFF00"},{color:"#00FF00"},{color:"#00FFFF"},{color:"#FF00FF"},{color:"#0000FF"}],[{color:"#FF0000"},{color:"#000080"},{color:"#008080"},{color:"#008000"},{color:"#800080"}],[{color:"#800000"},{color:"#808000"},{color:"#808080"},{color:"#C0C0C0"},{color:"#000000"}]],defaultColor:"#000000",insertShow:0,tableCell:[1,2,3,4,5,6,7,8,9,10],tableSize:{x:"",y:""},hoverIndex:0,currentFontSizeName:"10.5",family:c["e"].family,currentLineSpacing:1,options_font_family:["宋体","楷体","Arial","黑体","仿宋","微软雅黑","等线 Light","新宋体","等线","Times New Roman","华文中宋"],options_font_size:[],options_line_spacing:[1,1.25,1.5,1.75,2,2.5,3],insertData:[{text:"表格",svg:'<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><rect x=".5" y=".5" width="12" height="12" rx="1" transform="translate(1 1)" stroke="#3D4757"/><path fill="#3D4757" fill-rule="nonzero" d="M2 9h12v1H2zm0-4h12v1H2z"/><path fill="#3D4757" fill-rule="nonzero" d="M5 1h1v13H5zm4 0h1v13H9z"/></g></svg>'},{text:"链接",svg:'<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg"><g transform="rotate(45 5.5 13.328)" fill="#3D4757" fill-rule="evenodd"><path d="M7 6H6V3.515a2.5 2.5 0 1 0-5 0V6H0V3.515a3.5 3.5 0 1 1 7 0V6zm0 4v2.5a3.5 3.5 0 0 1-7 0V10h1v2.5a2.5 2.5 0 1 0 5 0V10h1z" fill-rule="nonzero"/><rect x="3.062" y="5.209" width="1" height="5.5" rx=".5"/></g></svg>'},{text:"图片",svg:'<svg fill="#3D4757" t="1600942691505" class="icon" viewBox="0 0 1027 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3144" width="16" height="16"><path d="M920.122 75.83600001H99.216c-50.328 0-91.272 40.945-91.272 91.27199998v692.00900001c0 50.328 40.944 91.271 91.272 91.27099999h820.906c50.327 0 91.27-40.944 91.27-91.27099999v-692.01c0.002-50.326-40.943-91.27-91.27-91.27zM99.216 142.351h820.906c13.651 0 24.75599999 11.106 24.756 24.75700001v492.71999998c-46.915-72.336-110.607-166.954-145.38-203.55599999-29.552-31.109-59.966-37.638-80.275-37.638h-0.001c-44.897 0-77.274 30.226-83.744 36.759-13.083 12.219-179.912 168.045-200.163 187.433-10.62000001-11.966-49.05-54.92-86.132-92.002-23.835-23.83600001-54.855-31.725-87.34700001-22.216-21.23600001 6.217-35.982 17.84400001-38.72099999 20.111l-0.26 0.215L74.459 676.90000001V167.10800001c0-13.651 11.106-24.757 24.757-24.75700001z m820.906 741.523H99.216c-13.651 0-24.757-11.107-24.757-24.757v-92.363L265.49 599.998c2.296-1.744 8.968-6.035 16.26600001-7.892 8.4-2.134 14.12-0.523 20.39299999 5.75 39.079 39.08 81.206 86.615 85.658 91.65200001 4.514 5.417 19.35 20.858 42.868 22.49399999 12.374 0.864 31.051-1.95600001 49.75299999-20.277 9.159-8.97200001 148.20400001-138.926 201.00900001-188.242l0.531-0.438 0.8-0.874c4.882-4.882 20.48399999-17.022 36.464-17.022l0.299 0.001c10.633 0.102 21.017 5.641 31.746 16.93399999 39.418 41.494 146.583 195.563 193.602 267.56700001v89.466c-0.001 13.65-11.107 24.757-24.758 24.757z" p-id="3145"></path><path d="M275.135 442.433c52.973 0 96.06799999-43.097 96.068-96.068s-43.095-96.06799999-96.068-96.068-96.06799999 43.095-96.068 96.068 43.096 96.06799999 96.068 96.068z m0-125.623c16.295 0 29.553 13.258 29.553 29.55400001s-13.258 29.553-29.553 29.55299999-29.553-13.258-29.553-29.55299999c0-16.296 13.258-29.554 29.553-29.55400001z" p-id="3146"></path></svg>'}],currentParagraph:{id:null},dialogVisible:!1,isMouseMove:!1,isCopy:!1,text_a:"",url_a:"",allowImgMove:!1,allowImgMovePosition:!1,downPlace:null,selectImgObj:null,shadowStyle:{display:"none"},tableSelectLine:{display:"none"},showTableSelectLine:!1,tableMoveLine:null,allowTableMove:!1,tableMoveLineStyle:{display:"none"},currentScrollTop:0,isShift:!1,insertDisable:!1,tableMenuListType:0,tableMenu:{show:!1,text:[{name:"复制",disable:!0},{name:"剪切",disable:!0},{name:"粘贴",disable:!0}],tableText:[{name:"插入行列",disable:!1,hasList:!0,type:1},{name:"删除行列",disable:!1,hasList:!0,type:2},{name:"合并单元格",disable:!1,type:3}],tableRow:{row:1,column:1},canMerge:!0},tableLineLimit:null,lineInTableData:null,layer_node:null,indent_left:0,indent_right:0,showSearchType:null,loadPageTimer:null,searchPlace:{left:1090,top:50}}},beforeMount:function(){this.show_page_idx.push(0)},mounted:function(){var t=this;I.DEBUG||window.addEventListener("beforeunload",this.leave),this.$nextTick((function(){I.DEBUG||t.openLoading(),t.initWord(),t.cursorBlink(),t.closeLoading(),c["g"].forEach((function(e,i){var a={label:e[0],value:e[1]};t.options_font_size.push(a)})),t.viewBoxDom=t.$refs["scrollSvgBox"],window.addEventListener("mousemove",t.windowMouseMove,!1),window.addEventListener("mousedown",t.windowMouseDown,!1),window.addEventListener("keydown",t.onKeyDown,!1),window.addEventListener("keyup",t.onKeyUp,!1),window.addEventListener("paste",t.onPaste,!1),window.addEventListener("resize",t.onResize,!1),t.viewBoxDom.addEventListener("scroll",t.onScroll,!1),t.$parent.$el.oncontextmenu=function(){return!1}}))},beforeDestroy:function(){this.off(),this.$style.remove(this),I.save(),window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.windowMouseMove),window.removeEventListener("mousedown",this.windowMouseDown),window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp),window.removeEventListener("paste",this.onPaste),window.removeEventListener("resize",this.onResize),this.viewBoxDom.removeEventListener("scroll",this.onScroll)},computed:{nowCellY:function(){var t=this.tableSize.y?this.tableSize.y:0;return t},nowCellX:function(){var t=this.tableSize.x?this.tableSize.x:0;return t}},methods:{leave:function(){I.save()},mountChildren:function(){},printAction:function(t,e){var i=this;this.isPrint=!0;for(var a=[],n=function(n){var r=!1;if(n>=t&&n<=e){var l={pageNum:n,isPrint:!0};a.push(l),r=!0}r||i.nowPageData.forEach((function(t){if(t.pageNum==n){var e={pageNum:n};a.push(e)}}))},r=1;r<=this.page_number;r++)n(r);function l(t){var e=document.getElementById("iframeBox");e&&e.remove(),e=document.createElement("IFRAME"),e.setAttribute("style","position:absolute;width:0px;height:0px;left:0;top:0;margin:0;"),e.setAttribute("id","iframeBox"),document.body.appendChild(e);var i=e.contentWindow.document;i.write(t);var a="html,body{height:100%;margin:0;}div{max-width:100%;max-height:100%;margin:0;top:0;}input{display:none;margin:0;}.currentPlace{display:none;}.printHide{display:none;}@media print {}",n=document.createElement("style");n.innerText=a;var r=document.createElement("style");r.setAttribute("media","print"),r.innerText="@page{size: auto;margin: 0mm;}",i.getElementsByTagName("head")[0].appendChild(n),i.getElementsByTagName("head")[0].appendChild(r),i.close(),e.contentWindow.focus(),e.contentWindow.print()}this.nowPageData=JSON.parse(JSON.stringify(a)),this.timer_print=setInterval((function(){var t=i.$el.querySelectorAll(".canvas-unit");if(t.length==i.nowPageData.length){i.nowPageData.forEach((function(t){L.repaint(t.pageNum-1,1)}));for(var e=i.$el.querySelector("#iframeDom"),a=0;a<t.length;a++)t[a].getAttribute("isPrint")&&e.appendChild(t[a].cloneNode(!0));i.isPrint=!1,i.showPrint=!1,i.printType=1,i.print_value="",l(e.outerHTML),e.innerHTML="",clearInterval(i.timer_print)}}),200)},submitPrint:function(){if(!this.isPrint)if(1!=this.printType)if(2!=this.printType)if(this.print_value&&3==this.printType)if(/^[0-9]*$/.test(this.print_value))0==this.print_value?this.err_text="页码不能为0":this.print_value>this.page_number?this.err_text="指定页输入超出范围":this.printAction(this.print_value,this.print_value);else if(-1!==this.print_value.indexOf("-")){var t=this.print_value.split("-")[0],e=this.print_value.split("-")[1];/^[0-9]*$/.test(t)&&/^[0-9]*$/.test(e)?t>this.page_number||e>this.page_number?this.err_text="指定页输入超出范围":t>e?this.err_text="指定页输入范围值不正确":this.printAction(t,e):this.err_text="指定页输入格式不正确"}else this.err_text="指定页输入格式不正确";else this.err_text="指定页输入范围值不正确";else this.printAction(this.currentPage_view,this.currentPage_view);else this.printAction(1,this.page_number)},cancelPrint:function(){this.printType=1,this.showPrint=!1,this.err_text=""},changePrintType:function(t){this.printType=t.value},initWord:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=I.toWord(e||this);this.setToolbar(i),this.paragraph_bullet=Object.values(i.paragraph_bullet);var a=new F(null,"无");this.paragraph_bullet.unshift(a),this.paragraph_number=Object.values(i.paragraph_number),this.paragraph_number.unshift(a),e&&(this.page_height=e.page_height,this.page_width=e.page_width,this.bg_color=e.bg_color,this.left_margin=e.left_margin||0,this.right_margin=e.right_margin||0,this.top_margin=e.top_margin||0,this.bottom_margin=e.bottom_margin||0,this.header_distance=i.header_distance||0,this.footer_distance=i.footer_distance||0,this.page_number=i.max_page),this.$nextTick((function(){var e=[],i=null,a=null,n=t.$refs["paragraph_bullet"];if(n){e=n.getElementsByTagName("svg");for(var l=1;l<t.paragraph_bullet.length;l++){a=e[l-1],i=t.paragraph_bullet[l];var s,o=Object(r["a"])(a.getElementsByTagName("text"));try{for(o.s();!(s=o.n()).done;){var h=s.value;h.innerHTML=i.format}}catch(_){o.e(_)}finally{o.f()}}}if(n=t.$refs["paragraph_number"],n)for(var d=n.getElementsByTagName("svg"),c=1;c<t.paragraph_number.length;c++){a=d[c-1],i=t.paragraph_number[c];for(var g=a.getElementsByTagName("text"),p=0;p<g.length;p++){var u=g[p];u.innerHTML=z["a"].get_paragraph_symbol(i,p+1)}}}));var n=this.left_margin+.5,l=this.top_margin+.5,s=this.right_margin+.5,o=this.bottom_margin+.5;this.path1="M ".concat(n-25," ").concat(l," L ").concat(n," ").concat(l," L ").concat(n," ").concat(l-25),this.path2="M ".concat(this.page_width-s+25," ").concat(l,"\n                  L ").concat(this.page_width-s," ").concat(l,"\n                  L ").concat(this.page_width-s," ").concat(l-25),this.path3="M ".concat(n-25," ").concat(this.page_height-o,"\n                  L ").concat(n," ").concat(this.page_height-o,"\n                  L ").concat(n," ").concat(this.page_height-o+25),this.path4="M ".concat(this.page_width-s+25," ").concat(this.page_height-o,"\n                  L ").concat(this.page_width-s," ").concat(this.page_height-o,"\n                  L ").concat(this.page_width-s," ").concat(this.page_height-o+25),this.path_header="M ".concat(this.left_margin," ").concat(this.top_margin,"\n                        L ").concat(this.left_margin," ").concat(this.header_distance,"\n                        L ").concat(this.page_width-this.right_margin," ").concat(this.header_distance,"\n                        L ").concat(this.page_width-this.right_margin," ").concat(this.top_margin,"\n                        M 0 ").concat(this.top_margin,"\n                        L ").concat(this.page_width," ").concat(this.top_margin),this.path_footer="M ".concat(this.left_margin," ").concat(this.page_height-this.top_margin,"\n                        L ").concat(this.left_margin," ").concat(this.page_height-this.footer_distance,"\n                        L ").concat(this.page_width-this.right_margin," ").concat(this.page_height-this.footer_distance,"\n                        L ").concat(this.page_width-this.right_margin," ").concat(this.page_height-this.bottom_margin,"\n                        M 0 ").concat(this.page_height-this.bottom_margin,"\n                        L ").concat(this.page_width," ").concat(this.page_height-this.bottom_margin),this.current_page_idx=0,this.calcViewHeight(),this.pageRepaint(!0,this.current_page_idx,this.page_number-1||1),this.inputDom=this.getInputDom()},asyncScrollMove:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.scroll_timer=setTimeout((function(){e.calcCanvasParam(t,i),e.scrollCursor(t,i,a),clearTimeout(e.scroll_timer),e.scroll_timer=null}),50)},getInputDom:function(){if(this.$refs.inputdom.length>0)for(var t=0;t<this.$refs.inputdom.length;t++)if(this.$refs.inputdom[t].getAttribute("page")==this.cursor_page_idx)return this.$refs.inputdom[t]},getCursorDom:function(t){for(var e=0;e<this.$refs.currentPlace.length;e++)if(this.$refs.currentPlace[e].getAttribute("page")==t){var i=this.$refs.currentPlace[e];return i}},getPageDom:function(t){for(var e=0;e<this.$refs.pageContent.children.length;e++)if(this.$refs.pageContent.children[e].dataset.index==t){var i=this.$refs.pageContent.children[e];return i}},setTextStyle:function(t){var e={color:this.font_color,size:this.font_size,family:this.family,weight:this.bold?"bold":null,style:this.italic?"italic":null};this.underline&&this.line_through?e.decoration="underline|line-through":this.underline?e.decoration="underline":this.line_through&&(e.decoration="line-through"),t.font=e,t.bg={color:this.bg_color}},cursorBlink:function(){var t=this;this.cursor_timer&&clearInterval(this.cursor_timer),this.cursor_timer=setInterval((function(){var e=t.getCursorDom(t.cursor_page_idx);e&&("0px"===e.style.width?e.style.width="2px":e.style.width=0,e.style.height=c["d"].g_cursor_height+"px")}),500)},stopTimer:function(){this.cursor_timer&&clearInterval(this.cursor_timer),this.outTimer&&clearTimeout(this.outTimer)},pageRepaint:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];null===i&&(i=this.begin_page_idx),null===a&&(a=this.update_page_number);var r=null;if(n)for(r=i+a;r<this.page_number;r++){var l=this.show_page_idx.indexOf(r);l>-1&&this.show_page_idx.splice(l,1)}for(var s=0;s<a;s++)r=s+i,this.show_page_idx.indexOf(r)<0&&this.show_page_idx.push(r);for(var o=0;o<this.show_page_idx.length;o++)r=this.show_page_idx[o],r+1>this.page_number&&this.show_page_idx.splice(o,1);if(e)var h=setTimeout((function(){t.page_number=L.repaint(i,a),clearTimeout(h)}),120);else this.page_number=L.repaint(i,a)},changeScale:function(t){var e=!1,i=this.nowScale;if(1==t&&this.nowScale>50?(this.nowScale-=10,e=!0):2==t&&this.nowScale<300&&(this.nowScale+=10,e=!0),e){this.pageHeight=this.pageHeight_view*this.nowScale/100,this.pageWidth=this.pageWidth_view*this.nowScale/100,this.page_space=20*this.nowScale/100,this.left_margin=this.left_margin_view*this.nowScale/100,this.top_margin=this.top_margin_view*this.nowScale/100,this.right_margin=this.right_margin_view*this.nowScale/100,this.bottom_margin=this.bottom_margin_view*this.nowScale/100;var a=this.getCursorDom();a.style.left=a.style.left.split("px")[0]*this.nowScale/i+"px",a.style.top=a.style.top.split("px")[0]*this.nowScale/i+"px",a.style.height=a.style.height.split("px")[0]*this.nowScale/i+"px"}},showTips:function(t,e){this.$refs.titleTips.innerHTML=e,this.$refs.titleTips.style.left=t.clientX-t.offsetX+"px",this.$refs.titleTips.style.top=t.clientY-t.offsetY+40+"px",this.$refs.titleTips.style.display="block"},closeTips:function(){this.$refs.titleTips.style.display="none"},setTableMenuList:function(t){this.tableMenuListType=t},menuOpera:function(t){if(this.lineInTableData){switch(t){case 1:I.operaTable("add_row",{row_idx:this.lineInTableData.row_idx,method:"top",num:1});break;case 2:I.operaTable("add_row",{row_idx:this.lineInTableData.row_idx,method:"bottom",num:1});break;case 3:I.operaTable("add_col",{col_idx:this.lineInTableData.col_idx,method:"left",num:1});break;case 4:I.operaTable("add_col",{col_idx:this.lineInTableData.col_idx,method:"right",num:1});break;case 5:break;case 6:break;case 7:break}this.tableMenu.show=!1,this.pageRepaint()}},tableMenuTextClick:function(t){if(!t.hasList&&!t.disable){switch(t.type){case 3:I.operaTable("merge_cells",{});break;case 4:break;case 5:break}this.pageRepaint()}},tableMousemove:function(t){if(!this.allowTableMove){var e=t.target;this.tableLineLimit={left:e.getAttribute("left"),right:e.getAttribute("right"),top:e.getAttribute("top"),bottom:e.getAttribute("bottom"),id:e.getAttribute("id"),node_begin:{x:Number(e.getAttribute("n_b_x")),y:Number(e.getAttribute("n_b_y"))},node_end:{x:Number(e.getAttribute("n_e_x")),y:Number(e.getAttribute("n_e_y"))}};var i=t.target.attributes.d.value.split(" ");i[1]=Number(i[1])*this.nowScale/100,i[2]=Number(i[2])*this.nowScale/100,i[4]=Number(i[4])*this.nowScale/100,i[5]=Number(i[5])*this.nowScale/100;var a={};i[2]==i[5]?(a.cursor="n-resize",a.width=i[4]-i[1],a.height=2,a.left=i[1],a.top=i[2]+this.top_margin-1):(a.cursor="e-resize",a.height=i[5]-i[2],a.width=2,a.left=i[1]-1,a.top=i[2]+this.top_margin),a.height&&a.width&&(this.showTableSelectLine=!0,this.setTableSelectLine(a))}},setTableSelectLine:function(t){var e={};e.height=t.height+"px",e.width=t.width+"px",e.left=t.left+"px",e.top=t.top+"px",e.cursor=t.cursor,e.display="block",this.tableSelectLine=e},clearTableSelectLine:function(){this.tableSelectLine={display:"none"}},tableSelectClick:function(t){},startMove:function(t,e){this.downPlace={index:e,x:t.clientX,y:t.clientY},this.allowImgMove=!0},onAllowImgMovePosition:function(t){this.downPlace={index:j["a"],x:t.clientX,y:t.clientY+this.currentScrollTop,position:{x:t.offsetX,y:t.offsetY}},this.allowImgMovePosition=!0,this.allowImgMove=!1},setShaDowImgStyle:function(t,e,i){if(t){var a={width:e.width>0?e.width+"px":"2px",height:e.height>0?e.height+"px":"2px"};switch(t){case 1:a.bottom=0,a.right=0;break;case 2:a.bottom="-1px",a.left=0;break;case 3:a.top=0,a.left=0;break;case 4:a.top="-1px",a.right=0;break}this.shadowStyle=a}else this.shadowStyle={top:this.downPlace.newY+"px",left:this.downPlace.newX+"px",height:e.height+"px",width:e.width+"px"}},setImgControlStyle:function(){var t={height:this.pageHeight+"px",top:45-this.currentScrollTop+this.page_space+this.cursor_page_idx*(this.pageHeight+this.page_space)+"px",left:(this.$refs.pageContent.clientWidth-this.pageWidth)/2+"px"};return t},setImgStyle:function(){var t={};if(this.selectImgObj){var e={height:this.selectImgObj.height*this.nowScale/100,width:this.selectImgObj.width*this.nowScale/100,left:this.selectImgObj.position.x*this.nowScale/100,top:this.selectImgObj.position.y*this.nowScale/100};t={height:e.height+"px",width:e.width+"px",top:this.top_margin+e.top+"px",left:e.left+"px"}}return t},showSearch:function(t){this.showSearchType=t},setToolbar:function(t){var e,i,a,n,l,s,o,h,d,g=this;if(t){this.cursor_cell=t.opera_cell,this.cursor_cell.page_idx!==this.cursor_page_idx&&(this.cursor_page_idx=this.cursor_cell.page_idx,this.inputDom=this.getInputDom());var p,u=setTimeout((function(){L.drawCursorByCell(g.cursor_cell),clearTimeout(u),u=null}),50),_=null===(e=this.cursor_cell)||void 0===e?void 0:e.node;if(!_||"text"!==_.type)_=null===(p=this.cursor_cell)||void 0===p?void 0:p.paragraph;if(this.font_size=(null===(i=_.font)||void 0===i?void 0:i.size)||c["e"].size,this.font_color=(null===(a=_.font)||void 0===a?void 0:a.color)||c["e"].color,this.bg_color=(null===(n=_.bg)||void 0===n?void 0:n.color)||"transparent",this.family=(null===(l=_.font)||void 0===l?void 0:l.family)||c["e"].family,-1===this.options_font_family.indexOf(this.family)&&this.options_font_family.push(this.family),this.underline=!1,this.line_through=!1,null!==(s=_.font)&&void 0!==s&&s.decoration&&(_.font.decoration.indexOf("underline")>-1&&(this.underline=!0),_.font.decoration.indexOf("line-through")>-1&&(this.line_through=!0)),this.bold=Boolean(null===(o=_.font)||void 0===o?void 0:o.weight)||!1,this.italic=Boolean(null===(h=_.font)||void 0===h?void 0:h.style)||!1,this.currentLineSpacing=(null===(d=_)||void 0===d?void 0:d.line_spacing)||c["e"].line_spacing,this.indent_left=_.indent_left?_.indent_left:0,this.indent_right=_.indent_right?_.indent_right:0,this.currentParagraph={id:null},this.nav_paragraph_bullet=!1,this.nav_paragraph_number=!1,_.paragraph_symbol){var v,f=Object(r["a"])(this.paragraph_bullet);try{for(f.s();!(v=f.n()).done;){var w=v.value;if(_.paragraph_symbol.id===w.id){this.currentParagraph=w,this.nav_paragraph_bullet=!0;break}}}catch(k){f.e(k)}finally{f.f()}if(!this.nav_paragraph_bullet){var m,x=Object(r["a"])(this.paragraph_number);try{for(x.s();!(m=x.n()).done;){var b=m.value;if(_.paragraph_symbol.id===b.id){this.currentParagraph=b,this.nav_paragraph_number=!0;break}}}catch(k){x.e(k)}finally{x.f()}}}"center"===_.horizontal?(this.nav4=!1,this.nav5=!0,this.nav6=!1):"right"===_.horizontal?(this.nav4=!1,this.nav5=!1,this.nav6=!0):(this.nav4=!0,this.nav5=!1,this.nav6=!1),"image"===_.type||_.parent&&"lite_table"===_.parent.type||this.isCopy?this.insertDisable=!0:this.insertDisable=!1;var y=!1;this.options_font_size.forEach((function(t,e){t.value!==g.font_size||y||(g.currentFontSizeName=t.label,y=!0)}))}},getPageContentStyle:function(){var t={height:this.page_number*(this.page_height+this.page_space)+"px"};return t},getPageStyle:function(t){var e={top:t*(this.page_height+this.page_space)+this.page_space+"px",backgroundColor:"#FFFFFF"};return e},svgBoxStyle:function(){var t={width:this.width||"100%",height:this.height||"100%","white-space":"normal"};return t},handelListShow:function(t){this.closeTips(),this.insertShow=this.insertShow==t?0:t,this.hoverIndex=0},save:function(){var t=this;this.openLoading(),new Promise((function(t,e){I.save(t)})).then((function(){t.closeLoading()}))},back:function(){this.closeTips(),this.insertShow=0;var t=I.back();t&&this.setToolbar(t),this.pageRepaint()},forward:function(){this.closeTips(),this.insertShow=0,I.forward(),this.pageRepaint()},formatBrush:function(){this.closeTips(),this.insertShow=0,this.nav3=!this.nav3,this.nav3&&(I.formatBrush(),this.pageRepaint())},formatClear:function(){this.closeTips(),this.insertShow=0,this.isCopy&&(I.formatClear(),this.pageRepaint())},textBaseStyleChange:function(t){this.closeTips(),this.inputDom.focus({preventScroll:!0});var e=null;switch(t){case 1:return I.operaTextSize(-1),void this.pageRepaint();case 2:return I.operaTextSize(1),void this.pageRepaint();case 3:this.bold=!this.bold,e=new D("",{weight:this.bold?"bold":null});break;case 4:this.italic=!this.italic,e=new D("",{style:this.italic?"italic":null});break;case 5:this.underline=!this.underline,e=this.underline&&this.line_through?new D("",{decoration:"underline|line-through"}):this.underline?new D("",{decoration:"underline"}):this.line_through?new D("",{decoration:"line-through"}):new D("",{decoration:null});break;case 6:this.line_through=!this.line_through,e=this.underline&&this.line_through?new D("",{decoration:"underline|line-through"}):this.underline?new D("",{decoration:"underline"}):this.line_through?new D("",{decoration:"line-through"}):new D("",{decoration:null});break;case 7:e=new D("",{color:this.font_color});break;case 8:e=new D("",null,{color:this.bg_color});break;default:break}e&&(I.operaText(e),this.pageRepaint())},handelSizeChange:function(t){this.closeTips(),this.font_size=t.value,this.currentFontSizeName=t.label;var e=new D("",{size:this.font_size});I.operaText(e),this.pageRepaint(),this.inputDom.focus({preventScroll:!0})},selectColorChange:function(t){this.font_color=t,this.textBaseStyleChange(7),this.insertShow=0,this.inputDom.focus({preventScroll:!0})},selectColorChangeBg:function(t){this.bg_color=t,this.textBaseStyleChange(8),this.insertShow=0,this.inputDom.focus({preventScroll:!0})},handelFamilyChange:function(t){if(this.closeTips(),this.family=t,this.isCopy){var e=new D("",{family:this.family});e.indent_left=this.indent_left,e.indent_right=this.indent_right,I.operaText(e)}this.inputDom.focus({preventScroll:!0})},handelLineSpaceChange:function(t){this.closeTips(),this.currentLineSpacing=t,I.lineSpacing(this.currentLineSpacing),this.pageRepaint()},showNav7:function(){this.closeTips(),this.nav_paragraph_bullet?this.setCurrentParagraphId(this.paragraph_bullet[0],"bullet"):this.setCurrentParagraphId(this.paragraph_bullet[1],"bullet")},showNav8:function(){this.closeTips(),this.nav_paragraph_number?this.setCurrentParagraphId(this.paragraph_number[0],"number"):this.setCurrentParagraphId(this.paragraph_number[1],"number")},setCurrentParagraphId:function(t,e){this.insertShow=0,this.currentParagraph=t,"number"===e?(this.nav_paragraph_bullet=!1,t.id?(I.paragraphFormat(t),this.nav_paragraph_number=!0):(I.paragraphFormat(null),this.nav_paragraph_number=!1)):(this.nav_paragraph_number=!1,t.id?(I.paragraphSymbol(t),this.nav_paragraph_bullet=!0):(I.paragraphSymbol(null),this.nav_paragraph_bullet=!1)),this.pageRepaint()},handelHover:function(t){this.insertDisable||(this.tableSize.x=0,this.tableSize.y=0,this.hoverIndex=t)},setLineStyle:function(t){switch(this.closeTips(),t){case 1:this.insertShow=0,this.nav4||(I.align("left"),this.nav4=!0,this.nav5=!1,this.nav6=!1,this.pageRepaint());break;case 2:this.insertShow=0,this.nav5?this.setLineStyle(1):(I.align("center"),this.nav5=!0,this.nav4=!1,this.nav6=!1,this.pageRepaint());break;case 3:this.insertShow=0,this.nav6?this.setLineStyle(1):(I.align("right"),this.nav6=!0,this.nav4=!1,this.nav5=!1,this.pageRepaint());break;case 4:break;case 5:break;case 6:6==this.insertShow?this.insertShow=0:this.insertShow=6;break;case 7:this.insertShow=0,I.indentation(-1),this.pageRepaint();break;case 8:this.insertShow=0,I.indentation(1),this.pageRepaint();break;case 9:9==this.insertShow?this.insertShow=0:this.insertShow=9;break;case 10:10==this.insertShow?this.insertShow=0:this.insertShow=10;break;case 11:this.insertShow=0;break;case 12:this.insertShow=0;break;case 13:this.insertShow=0,this.showPrint=!0;break;case 14:var e=this,i=function(t){e.closeLoading(),t&&e.$step.run(e,{type:"download_file",href:t,name:""})};this.openLoading(),I.export(this.export_url,i),this.insertShow=0;break;case 15:this.insertShow=0,this.$refs.upDoc.click();break}},insertClick:function(t){1===t&&(this.dialogVisible=!0),2===t&&this.$refs.upImg.click()},submitImg:function(t){var e=this,i=new FormData,a=t.target.files||t.dataTransfer.files;i.append("file",a[0]);var n=new FileReader;n.onload=function(t){var i=new Image;i.src=t.target.result,i.onload=function(){var a=i.width,n=i.height,r=new I.WordImage(t.target.result,a,n);r.indent_left=e.indent_left,r.indent_right=e.indent_right,e.selectImgObj=I.insertImage(r).opera_cell.node,e.pageRepaint(),e.insertDisable=!0,e.$refs.upImg.value=""}},n.readAsDataURL(t.target.files[0])},submitDoc:function(t){var e=this;if(this.import_url){I.DEBUG||this.openLoading();var i=new FormData,a=t.target.files||t.dataTransfer.files;if(i.append("file",a[0]),a[0].size>2097152)return this.$step.msg(this,{text:"暂时无法上传大于200M的文件",msg_type:"warning"}),void this.closeLoading();Object(s["a"])({method:"post",params:i,url:this.import_url,header:"multipart/form-data"}).then((function(i){if(e.closeLoading(),e.$refs.upDoc.value="",i.step)e.$step.run_batch(e,i.step);else{try{e.viewBoxDom.scrollTo(0,0)}catch(t){}e.initWord(i)}})).catch((function(t){console.log(t.stack),e.$refs.upDoc.value="",e.closeLoading()}))}},openLoading:function(){this.layer_node=Object(l["mount"])(V["a"],{props:{move:0,mask:1,loading:1},target:this.$root.$el,mode:"append"})},closeLoading:function(){this.layer_node&&(this.layer_node.close(),this.layer_node=null)},handleClose:function(t){if(this.insertShow=0,this.hoverIndex=0,1==t){if(this.url_a&&this.text_a){var e=this.getNowFontStyle(),i=new D(this.text_a,e,null,this.url_a);i.indent_left=this.indent_left,i.indent_right=this.indent_right,this.nav5?i.horizontal="center":this.nav6&&(i.horizontal="right"),this.setToolbar(I.input(i),!0),this.url_a="",this.text_a="",this.dialogVisible=!1}}else this.url_a="",this.text_a="",this.dialogVisible=!1},tableCellMove:function(t){var e={x:"",y:""},i=t.offsetX-16,a=t.offsetY-46;i>0&&(e.x=Math.ceil(i/22)>10?10:Math.ceil(i/22)),a>0&&(e.y=Math.ceil(a/20)>10?10:Math.ceil(a/20)),this.tableSize.x=e.x,this.tableSize.y=e.y},insertTable:function(){if(this.tableSize.x&&this.tableSize.y){var t=JSON.parse(JSON.stringify(this.tableSize));this.hoverIndex=0,this.insertShow=0,I.insertTable(t),this.pageRepaint(),this.insertDisable=!0}},getNowFontStyle:function(){var t={color:this.font_color,size:this.font_size,family:this.family};return t.weight=this.bold?"bold":null,t.style=this.italic?"italic":null,this.underline&&this.line_through?t.decoration="underline|line-through":this.underline?t.decoration="underline":this.line_through&&(t.decoration="line-through"),t},calcViewHeight:function(){return this.view_height=this.$refs.svgBox.getBoundingClientRect().height-75,this.show_page_number=Math.ceil(this.view_height/(this.page_height+this.page_space)),this.update_page_number=this.show_page_number+1,this.view_height},calcCanvasParam:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t&&(this.page_number=t.max_page);var e=null,i=null;e=this.viewBoxDom.scrollTop,i=e+this.view_height,this.current_page_idx=Math.ceil(i/(this.page_height+this.page_space))-1,this.current_page_idx>=this.page_number?this.current_page_idx=this.page_number-1:t&&t.opera_cell.page_idx>this.current_page_idx?this.current_page_idx=t.opera_cell.page_idx:this.current_page_idx<0&&(this.current_page_idx=0);var a=(e+this.view_height)/(this.page_height+this.page_space);a<1?(this.begin_page_idx=0,this.page_number>1?this.update_page_number=2:this.update_page_number=1):(this.update_page_number=this.show_page_number+1,this.begin_page_idx=this.current_page_idx-1)},scrollCursor:function(){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,e=this.viewBoxDom.scrollTop,i=this.cursor_cell.end.y,a=this.cursor_cell.page_idx,n=null,r=a*(this.page_height+this.page_space)+i;t?e+this.view_height-60<r&&(n=a*(this.page_height+this.page_space)-this.view_height+i+60,this.viewBoxDom.scrollTo({top:n,behavior:"instant"})):(n=a*(this.page_height+this.page_space)+i,n<e&&this.viewBoxDom.scrollTo({top:n,behavior:"instant"}))},onPaste:function(t){var e=t||window.event;if(this.isCopy)this.setToolbar(I.paste(),!0);else{var i=e.clipboardData||window.clipboardData,a=(i.getData("text/html"),i.getData("text/plain"));a&&this.setToolbar(I.paste(a),!0)}},onResize:function(t){this.calcViewHeight()},onScroll:function(t){if(this.calcCanvasParam(),this.show_page_idx.indexOf(this.current_page_idx)<0){this.show_page_idx.push(this.current_page_idx);var e=I.recalculate(this.current_page_idx,1);this.page_number=e.max_page,this.pageRepaint(!0,this.current_page_idx,1)}},onKeyDown:function(t){var e=this;if(!this.showPrint&&!this.dialogVisible){var i=t.keyCode||t.which||t.charCode;if(t.ctrlKey||navigator.userAgent.toLowerCase().indexOf("mac os")>-1&&t.metaKey){switch(i){case 65:break;case 66:return this.textBaseStyleChange(3),!0;case 67:I.copy();break;case 70:break;case 72:break;case 73:return this.textBaseStyleChange(4),!0;case 83:break;case 85:return this.textBaseStyleChange(5),!0;case 86:return!1;case 89:break;case 90:this.back();break;default:return}return!0}if(t.shiftKey)this.isShift=!0;else{if(27===i)return this.isEditHead=!1,void(this.selectImgObj=null);if(112<=i&&i<=123)return;if(20===i)return}var a=!1,n=!1,r=!1;if(t.key){t.preventDefault();var l=null;switch(i){case 46:l=I.delete();break;case 8:n=!0,l=I.backspace();break;case 13:a=!0,l=I.enter();break;case 16:return;case 35:case 36:case 37:n=!0,r=!0,l=I.keyDown(i,this.isShift);break;case 38:n=!0,r=!0,l=I.keyDown(i,this.isShift);break;case 39:a=!0,r=!0,l=I.keyDown(i,this.isShift);break;case 40:a=!0,r=!0,l=I.keyDown(i,this.isShift);break;default:return this.input_text+=9===i?"    ":t.key,void(this.input_timer||(this.input_timer=setTimeout((function(){var t=new D(e.input_text);e.setTextStyle(t),l=I.input(t),e.setToolbar(l),e.calcCanvasParam(l,a),e.scrollCursor(l,a,n),e.pageRepaint(!1),e.input_text="",clearTimeout(e.input_timer),e.input_timer=null}),100)))}this.setToolbar(l),this.calcCanvasParam(l,a),this.asyncScrollMove(l,a,n),this.pageRepaint(!0,null,null,!r)}}},onKeyUp:function(t){this.isShift=!1},onMouseDown:function(t,e){this.insertShow=0;var i=t.offsetX,a=t.offsetY,n=I.click(e,100*i/this.nowScale,100*a/this.nowScale,this.isShift);this.setToolbar(n),this.scrollCursor(n),this.mouse_down=!0},onMouseMove:function(t,e){var i=this;this.mouse_timer&&clearTimeout(this.mouse_timer),this.mouse_down&&(this.mouse_timer=setTimeout((function(){I.select(e,100*t.offsetX/i.nowScale,100*t.offsetY/i.nowScale),i.mouse_timer=null})))},onMouseUp:function(t,e){this.mouse_down=!1},windowMouseDown:function(t){0===t.button&&0==this.tableMenuListType&&(this.tableMenu.show=!1)},windowMouseMove:function(t){if(this.selectImgObj){var e=Object.assign({},this.selectImgObj);if(e.width=e.width*this.nowScale/100,e.height=e.height*this.nowScale/100,this.allowImgMove){var i=e.height/e.width,a=t.clientX-this.downPlace.x,n=t.clientY-this.downPlace.y;switch(this.downPlace.index){case 1:a=this.downPlace.x-t.clientX,a+e.width>this.pageWidth-this.left_margin-this.right_margin?e.width=this.pageWidth-this.left_margin-this.right_margin:e.width+=a,e.height=i*e.width,this.setShaDowImgStyle(1,e);break;case 2:n=this.downPlace.y-t.clientY,e.height+=n,e.height>this.pageHeight-this.top_margin-this.bottom_margin&&(e.height=this.pageHeight-this.top_margin-this.bottom_margin),this.setShaDowImgStyle(1,e);break;case 3:a+e.width>this.pageWidth-this.left_margin-this.right_margin?e.width=this.pageWidth-this.left_margin-this.right_margin:e.width+=a,e.height=i*e.width,this.setShaDowImgStyle(2,e);break;case 4:a+e.width>this.pageWidth-this.left_margin-this.right_margin?e.width=this.pageWidth-this.left_margin-this.right_margin:e.width+=a,this.setShaDowImgStyle(2,e);break;case 5:a+e.width>this.pageWidth-this.left_margin-this.right_margin?e.width=this.pageWidth-this.left_margin-this.right_margin:e.width+=a,e.height=i*e.width,this.setShaDowImgStyle(3,e);break;case 6:e.height+=n,e.height>this.pageHeight-this.top_margin-this.bottom_margin&&(e.height=this.pageHeight-this.top_margin-this.bottom_margin),this.setShaDowImgStyle(3,e);break;case 7:a=this.downPlace.x-t.clientX,a+e.width>this.pageWidth-this.left_margin-this.right_margin?e.width=this.pageWidth-this.left_margin-this.right_margin:e.width+=a,e.height=i*e.width,this.setShaDowImgStyle(4,e);break;case 8:a=this.downPlace.x-t.clientX,a+e.width>this.pageWidth-this.left_margin-this.right_margin?e.width=this.pageWidth-this.left_margin-this.right_margin:e.width+=a,this.setShaDowImgStyle(4,e);break}}if(!this.allowImgMove){var r=Object.assign({},this.selectImgObj);if(this.allowImgMovePosition){var l=t.clientX-this.downPlace.x+this.downPlace.position.x,s=t.clientY-this.downPlace.y+this.downPlace.position.y+this.currentScrollTop;this.downPlace.newX=l,this.downPlace.newY=s,this.setShaDowImgStyle(!1,r)}}}if(this.allowTableMove){if(this.tableMoveLineStyle.height){var o=t.clientX-this.tableMoveLine.pageData.x;o>0?0==this.tableLineLimit.right?o=0:-1!=this.tableLineLimit.right&&o>this.tableLineLimit.right&&(o=this.tableLineLimit.right):0==this.tableLineLimit.left?o=0:-1!=this.tableLineLimit.left&&-o>this.tableLineLimit.left&&(o=-this.tableLineLimit.left);var h=this.tableMoveLine.pageData.x+Number(o);this.tableMoveLineStyle.left=h+"px"}else{var d=t.clientY-this.tableMoveLine.pageData.y;d>0?0==this.tableLineLimit.bottom?d=0:-1!=this.tableLineLimit.bottom&&d>this.tableLineLimit.bottom&&(d=this.tableLineLimit.bottom):0==this.tableLineLimit.top?d=0:-1!=this.tableLineLimit.top&&-d>this.tableLineLimit.top&&(d=-this.tableLineLimit.top);var c=this.tableMoveLine.pageData.y+Number(d);this.tableMoveLineStyle.top=c+"px"}this.tableMoveLineStyle=Object.assign({},this.tableMoveLineStyle)}}}},$=q,W=(i("8332"),i("150e"),i("2877")),J=Object(W["a"])($,a,n,!1,null,"2df54982",null);e["default"]=J.exports},"741e":function(t,e,i){},8332:function(t,e,i){"use strict";i("741e")},"9bdd":function(t,e,i){var a=i("825a"),n=i("2a62");t.exports=function(t,e,i,r){try{return r?e(a(i)[0],i[1]):e(i)}catch(l){n(t,"throw",l)}}},a630:function(t,e,i){var a=i("23e7"),n=i("4df4"),r=i("1c7e"),l=!r((function(t){Array.from(t)}));a({target:"Array",stat:!0,forced:l},{from:n})},c5d0:function(t,e,i){"use strict";var a=i("23e7"),n=i("857a"),r=i("af03");a({target:"String",proto:!0,forced:r("italics")},{italics:function(){return n(this,"i","","")}})},cc71:function(t,e,i){"use strict";var a=i("23e7"),n=i("857a"),r=i("af03");a({target:"String",proto:!0,forced:r("bold")},{bold:function(){return n(this,"b","","")}})},d17e:function(t,e,i){}}]);